CREATE TABLE DPMC_AIT_BL_INFO_test( BILL_OF_LADING_ID VARCHAR(19) Not Null primary key,
BILL_OF_LADING_NUM VARCHAR2(20) NOT NULL ,
OB_VOYAGE_CODE VARCHAR2(20),
PORT_OF_lOADING_ID VARCHAR2(20),
IB_VOYAGE_CODE VARCHAR2(20),
IB_OFFICE_CODE VARCHAR2(20),
SHIPPER_ID VARCHAR(20),
CONSIGNEE_ID VARCHAR(20),
BL_STATE VARCHAR2(50),
ESTIMATED_BERTH_ARRIVAL VARCHAR2(18)
);

Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613745311,'4037302540','GTX-VDC-028 E',719087582548006,'SC2-OIM-026 E','NYC','6497004000','6497004000','B/L Ready',null);	
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000512456616,'2021533120','LP5-HSM-017 W',719087582548060,null,null,'3167785000','6819840000','B/L Proforma Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000512981147,'2564922870','CAS-LL8-444 S',719087582548199,'AAA2-EMY-158 N','MEL','7451222000','7343505000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000512991711,'2564959210','KTX1-ONZ-016 N',719087582548122,null,null,'3067728000','4075659000','B/L Proforma Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000612744116,'4017347890','NP3-VIX-033 W',719087582547969,'NP3-VIX-034 E','SHA','6410112000','6410112000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613671910,'4000014530','AEA1-OSH-011 N',719087582547992,null,null,'4143529000',null,'Preparation In Progress',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000612651382,'4017318929','LP1-BII-006 E',719087582548006,null,null,'4143529000','6497004000','Preparation In Progress',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000612698735,'4017321560',null,719087582548122,null,null,'6652215000',null,'Preparation In Progress',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613738885,'4037302000',null,719087582548006,null,null,'6497004000',null,'Preparation In Progress',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613740278,'4037302120','NP3-VIX-033 W',719087582547969,'NP3-VIX-034 E','SHA','6410112000','6410112000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613745321,'4037302520','MPX-IND-106 S',719087582548006,'SC2-OIM-026 E','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613745331,'4037302560','SC2-OIM-026 E',719087582548006,'SC2-OIM-026 E','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613745381,'4037302560','MVN-TES-096 W',719087582548006,'SC2-OIM-026 E','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613745313,'4037302540','SC2-OIM-026 N',719087582548006,'SC2-OIM-026 E','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613745421,'4037302360','SC2-OIM-106 E',719087582548006,'SC2-OIM-026 E','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613745431,'4037304340','MVN-TES-096 W',719087582548006,'MVN-TES-096 W','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613225311,'4037302230','AEA1-OSH-011 N',719087582548006,'AEA1-OSH-011 N','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613746911,'4037306940','MON-POG-106 E',719087582548006,'MON-POG-106 E','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000613696911,'4037306960','MON-POG-106 E',719087582548006,'MON-POG-106 E','NYC','6497004000','6497004000','B/L Ready',null);
Insert into DPMC_AIT_BL_INFO_TEST values (1000000000512986947,'2564926970','CAS-LL8-444 S',719087582548199,'AAA2-EMY-158 N','MEL','7451222000','7343505000','B/L Ready',null);
commit;

select * from DPMC_AIT_BL_INFO_TEST;

--Exercise1
select * from DPMC_AIT_BL_INFO_TEST;
select count(*), IB_OFFICE_CODE from DPMC_AIT_BL_INFO_TEST group By IB_OFFICE_CODE;
--Exercise2
select * from DPMC_AIT_BL_INFO_TEST where IB_OFFICE_CODE='NYC';
--Exercise3
select * from DPMC_AIT_BL_INFO_TEST 
where BILL_OF_LADING_NUM between '4037302520' and '4037302560';
--Exercise4
select * from DPMC_AIT_BL_INFO_TEST 
where BILL_OF_LADING_NUM between '4037302520' and '4037302560'
or IB_OFFICE_CODE = 'SHA';
--Exercise5
select * from DPMC_AIT_BL_INFO_TEST 
where IB_VOYAGE_CODE in ('SC2-OIM-026 E','NP3-VIX-034 E');
--Exercise6
select * from DPMC_AIT_BL_INFO_TEST
where IB_OFFICE_CODE is null;
--Exercise7
select count(distinct(bill_of_lading_num)) from DPMC_AIT_BL_INFO_TEST;
select * from DPMC_AIT_BL_INFO_TEST
where OB_VOYAGE_CODE in (SELECT DISTINCT(IB_VOYAGE_CODE) from DPMC_AIT_BL_INFO_TEST);
--Exercise8
select * from DPMC_AIT_BL_INFO_TEST
where IB_VOYAGE_CODE like '%POG-1%';
select * from DPMC_AIT_BL_INFO_TEST
where IB_VOYAGE_CODE like 'MON%';
select * from DPMC_AIT_BL_INFO_TEST
where IB_VOYAGE_CODE like '%N';
