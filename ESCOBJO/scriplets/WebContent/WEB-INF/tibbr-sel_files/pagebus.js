window.OpenAjax||(OpenAjax=new function(){this.hub={},h=this.hub,h.implementer="http://openajax.org",h.implVersion="2.0",h.specVersion="2.0",h.implExtraData={};var a={};h.libraries=a;var b="org.openajax.hub.";h.registerLibrary=function(c,d,e,f){a[c]={prefix:c,namespaceURI:d,version:e,extraData:f},this.publish(b+"registerLibrary",a[c])},h.unregisterLibrary=function(c){this.publish(b+"unregisterLibrary",a[c]),delete a[c]}},OpenAjax.hub.Error={BadParameters:"OpenAjax.hub.Error.BadParameters",Disconnected:"OpenAjax.hub.Error.Disconnected",Duplicate:"OpenAjax.hub.Error.Duplicate",NoContainer:"OpenAjax.hub.Error.NoContainer",NoSubscription:"OpenAjax.hub.Error.NoSubscription",NotAllowed:"OpenAjax.hub.Error.NotAllowed",WrongProtocol:"OpenAjax.hub.Error.WrongProtocol"},OpenAjax.hub.SecurityAlert={LoadTimeout:"OpenAjax.hub.SecurityAlert.LoadTimeout",FramePhish:"OpenAjax.hub.SecurityAlert.FramePhish",ForgedMsg:"OpenAjax.hub.SecurityAlert.ForgedMsg"},OpenAjax.hub._debugger=function(){if(OpenAjax.hub.enableDebug)debugger},OpenAjax.hub.ManagedHub=function(a){if(!a||!a.onPublish||!a.onSubscribe)throw new Error(OpenAjax.hub.Error.BadParameters);this._p=a,this._onUnsubscribe=a.onUnsubscribe?a.onUnsubscribe:null,this._scope=a.scope||window;if(a.log){var b=this._scope,c=a.log;this._log=function(a){c.call(b,"ManagedHub: "+a)}}else this._log=function(){};this._subscriptions={c:{},s:null},this._containers={},this._seq=0,this._active=!0,this._isPublishing=!1,this._pubQ=[]},OpenAjax.hub.ManagedHub.prototype.subscribeForClient=function(a,b,c){this._assertConn();if(this._invokeOnSubscribe(b,a))return this._subscribe(b,this._sendToClient,this,{c:a,sid:c});throw new Error(OpenAjax.hub.Error.NotAllowed)},OpenAjax.hub.ManagedHub.prototype.unsubscribeForClient=function(a,b){this._unsubscribe(b),this._invokeOnUnsubscribe(a,b)},OpenAjax.hub.ManagedHub.prototype.publishForClient=function(a,b,c){this._assertConn(),this._publish(b,c,a)},OpenAjax.hub.ManagedHub.prototype.disconnect=function(){this._active=!1;for(var a in this._containers)this.removeContainer(this._containers[a])},OpenAjax.hub.ManagedHub.prototype.getContainer=function(a){var b=this._containers[a];return b?b:null},OpenAjax.hub.ManagedHub.prototype.listContainers=function(){var a=[];for(var b in this._containers)a.push(this._containers[b]);return a},OpenAjax.hub.ManagedHub.prototype.addContainer=function(a){this._assertConn();var b=a.getClientID();if(this._containers[b])throw new Error(OpenAjax.hub.Error.Duplicate);this._containers[b]=a},OpenAjax.hub.ManagedHub.prototype.removeContainer=function(a){var b=a.getClientID();if(!this._containers[b])throw new Error(OpenAjax.hub.Error.NoContainer);a.remove(),delete this._containers[b]},OpenAjax.hub.ManagedHub.prototype.subscribe=function(a,b,c,d,e){function g(a,d,g,h){if(f._invokeOnPublish(a,d,h,null))try{b.call(c,a,d,e)}catch(i){OpenAjax.hub._debugger(),f._log("caught error from onData callback to Hub.subscribe(): "+i.message)}}this._assertConn(),this._assertSubTopic(a);if(!b)throw new Error(OpenAjax.hub.Error.BadParameters);if(!this._invokeOnSubscribe(a,null)){this._invokeOnComplete(d,c,null,!1,OpenAjax.hub.Error.NotAllowed);return}c=c||window;var f=this,h=this._subscribe(a,g,c,e);return this._invokeOnComplete(d,c,h,!0),h},OpenAjax.hub.ManagedHub.prototype.publish=function(a,b){this._assertConn(),this._assertPubTopic(a),this._publish(a,b,null)},OpenAjax.hub.ManagedHub.prototype.unsubscribe=function(a,b,c){this._assertConn();if(typeof a=="undefined"||a==null)throw new Error(OpenAjax.hub.Error.BadParameters);this._unsubscribe(a),this._invokeOnUnsubscribe(null,a),this._invokeOnComplete(b,c,a,!0)},OpenAjax.hub.ManagedHub.prototype.isConnected=function(){return this._active},OpenAjax.hub.ManagedHub.prototype.getScope=function(){return this._scope},OpenAjax.hub.ManagedHub.prototype.getSubscriberData=function(a){this._assertConn();var b=a.split("."),c=b.pop(),d=this._getSubscriptionObject(this._subscriptions,b,0,c);if(d)return d.data;throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.ManagedHub.prototype.getSubscriberScope=function(a){this._assertConn();var b=a.split("."),c=b.pop(),d=this._getSubscriptionObject(this._subscriptions,b,0,c);if(d)return d.scope;throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.ManagedHub.prototype.getParameters=function(){return this._p},OpenAjax.hub.ManagedHub.prototype._sendToClient=function(a,b,c,d){if(!this.isConnected())return;this._invokeOnPublish(a,b,d,c.c)&&c.c.sendToClient(a,b,c.sid)},OpenAjax.hub.ManagedHub.prototype._assertConn=function(){if(!this.isConnected())throw new Error(OpenAjax.hub.Error.Disconnected)},OpenAjax.hub.ManagedHub.prototype._assertPubTopic=function(a){if(a==null||a==""||a.indexOf("*")!=-1||a.indexOf("..")!=-1||a.charAt(0)=="."||a.charAt(a.length-1)==".")throw new Error(OpenAjax.hub.Error.BadParameters)},OpenAjax.hub.ManagedHub.prototype._assertSubTopic=function(a){if(!a)throw new Error(OpenAjax.hub.Error.BadParameters);var b=a.split("."),c=b.length;for(var d=0;d<c;d++){var e=b[d];if(e==""||e.indexOf("*")!=-1&&e!="*"&&e!="**")throw new Error(OpenAjax.hub.Error.BadParameters);if(e=="**"&&d<c-1)throw new Error(OpenAjax.hub.Error.BadParameters)}},OpenAjax.hub.ManagedHub.prototype._invokeOnComplete=function(a,b,c,d,e){if(a)try{b=b||window,a.call(b,c,d,e)}catch(f){OpenAjax.hub._debugger(),this._log("caught error from onComplete callback: "+f.message)}},OpenAjax.hub.ManagedHub.prototype._invokeOnPublish=function(a,b,c,d){try{return this._p.onPublish.call(this._scope,a,b,c,d)}catch(e){OpenAjax.hub._debugger(),this._log("caught error from onPublish callback to constructor: "+e.message)}return!1},OpenAjax.hub.ManagedHub.prototype._invokeOnSubscribe=function(a,b){try{return this._p.onSubscribe.call(this._scope,a,b)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onSubscribe callback to constructor: "+c.message)}return!1},OpenAjax.hub.ManagedHub.prototype._invokeOnUnsubscribe=function(a,b){if(this._onUnsubscribe){var c=b.slice(0,b.lastIndexOf("."));try{this._onUnsubscribe.call(this._scope,c,a)}catch(d){OpenAjax.hub._debugger(),this._log("caught error from onUnsubscribe callback to constructor: "+d.message)}}},OpenAjax.hub.ManagedHub.prototype._subscribe=function(a,b,c,d){var e=a+"."+this._seq,f={scope:c,cb:b,data:d,sid:this._seq++},g=a.split(".");return this._recursiveSubscribe(this._subscriptions,g,0,f),e},OpenAjax.hub.ManagedHub.prototype._recursiveSubscribe=function(a,b,c,d){var e=b[c];c==b.length?(d.next=a.s,a.s=d):(typeof a.c=="undefined"&&(a.c={}),typeof a.c[e]=="undefined"?(a.c[e]={c:{},s:null},this._recursiveSubscribe(a.c[e],b,c+1,d)):this._recursiveSubscribe(a.c[e],b,c+1,d))},OpenAjax.hub.ManagedHub.prototype._publish=function(a,b,c){if(this._isPublishing){this._pubQ.push({t:a,d:b,p:c});return}this._safePublish(a,b,c);while(this._pubQ.length>0){var d=this._pubQ.shift();this._safePublish(d.t,d.d,d.p)}},OpenAjax.hub.ManagedHub.prototype._safePublish=function(a,b,c){this._isPublishing=!0;var d=a.split(".");this._recursivePublish(this._subscriptions,d,0,a,b,c),this._isPublishing=!1},OpenAjax.hub.ManagedHub.prototype._recursivePublish=function(a,b,c,d,e,f){if(typeof a!="undefined"){var g;c==b.length?g=a:(this._recursivePublish(a.c[b[c]],b,c+1,d,e,f),this._recursivePublish(a.c["*"],b,c+1,d,e,f),g=a.c["**"]);if(typeof g!="undefined"){var h=g.s;while(h){var i=h.scope,j=h.cb,k=h.data,l=h.sid;typeof j=="string"&&(j=i[j]),j.call(i,d,e,k,f),h=h.next}}}},OpenAjax.hub.ManagedHub.prototype._unsubscribe=function(a){var b=a.split("."),c=b.pop();if(!this._recursiveUnsubscribe(this._subscriptions,b,0,c))throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.ManagedHub.prototype._recursiveUnsubscribe=function(a,b,c,d){if(typeof a=="undefined")return!1;if(c<b.length){var e=a.c[b[c]];if(!e)return!1;this._recursiveUnsubscribe(e,b,c+1,d);if(e.s==null){for(var f in e.c)return!0;delete a.c[b[c]]}}else{var g=a.s,h=null,i=!1;while(g){if(d==g.sid){i=!0,g==a.s?a.s=g.next:h.next=g.next;break}h=g,g=g.next}if(!i)return!1}return!0},OpenAjax.hub.ManagedHub.prototype._getSubscriptionObject=function(a,b,c,d){if(typeof a!="undefined"){if(c<b.length){var e=a.c[b[c]];return this._getSubscriptionObject(e,b,c+1,d)}var f=a.s;while(f){if(d==f.sid)return f;f=f.next}}return null},OpenAjax.hub._hub=new OpenAjax.hub.ManagedHub({onSubscribe:function(a,b){return!0},onPublish:function(a,b,c,d){return!0}}),OpenAjax.hub.subscribe=function(a,b,c,d){return typeof b=="string"&&(c=c||window,b=c[b]||null),OpenAjax.hub._hub.subscribe(a,b,c,null,d)},OpenAjax.hub.unsubscribe=function(a){return OpenAjax.hub._hub.unsubscribe(a)},OpenAjax.hub.publish=function(a,b){OpenAjax.hub._hub.publish(a,b)},OpenAjax.hub.registerLibrary("OpenAjax","http://openajax.org/hub","2.0",{})),OpenAjax.hub.InlineContainer=function(a,b,c){if(!a||!b||!c||!c.Container||!c.Container.onSecurityAlert)throw new Error(OpenAjax.hub.Error.BadParameters);this._params=c,this._hub=a,this._id=b,this._onSecurityAlert=c.Container.onSecurityAlert,this._onConnect=c.Container.onConnect?c.Container.onConnect:null,this._onDisconnect=c.Container.onDisconnect?c.Container.onDisconnect:null,this._scope=c.Container.scope||window;if(c.Container.log){var d=this._scope,e=c.Container.log;this._log=function(a){e.call(d,"InlineContainer::"+b+": "+a)},this._doLog=!0}else this._log=function(){};this._connected=!1,this._subs=[],this._subIndex=1,a.addContainer(this)},OpenAjax.hub.InlineContainer.prototype.getHub=function(){return this._hub},OpenAjax.hub.InlineContainer.prototype.sendToClient=function(a,b,c){if(this.isConnected()){var d=this._subs[c];try{d.cb.call(d.sc,a,b,d.d)}catch(e){OpenAjax.hub._debugger(),this._client._log("caught error from onData callback to HubClient.subscribe(): "+e.message)}}},OpenAjax.hub.InlineContainer.prototype.remove=function(){this.isConnected()&&this._disconnect()},OpenAjax.hub.InlineContainer.prototype.isConnected=function(){return this._connected},OpenAjax.hub.InlineContainer.prototype.getClientID=function(){return this._id},OpenAjax.hub.InlineContainer.prototype.getPartnerOrigin=function(){return this._connected?(this._cacheOrig||(this._cacheOrig=window.location.protocol+"//"+window.location.hostname),this._cacheOrig):null},OpenAjax.hub.InlineContainer.prototype.getParameters=function(){return this._params},OpenAjax.hub.InlineContainer.prototype.connect=function(a,b,c){if(this._connected)throw new Error(OpenAjax.hub.Error.Duplicate);this._connected=!0,this._client=a;if(this._onConnect)try{this._onConnect.call(this._scope,this)}catch(d){OpenAjax.hub._debugger(),this._log("caught error from onConnect callback to constructor: "+d.message)}this._invokeOnComplete(b,c,a,!0)},OpenAjax.hub.InlineContainer.prototype.disconnect=function(a,b,c){if(!this._connected)throw new Error(OpenAjax.hub.Error.Disconnected);this._disconnect();if(this._onDisconnect)try{this._onDisconnect.call(this._scope,this)}catch(d){OpenAjax.hub._debugger(),this._log("caught error from onDisconnect callback to constructor: "+d.message)}this._invokeOnComplete(b,c,a,!0)},OpenAjax.hub.InlineContainer.prototype.subscribe=function(a,b,c,d,e){this._assertConn(),this._assertSubTopic(a);if(!b)throw new Error(OpenAjax.hub.Error.BadParameters);var f=""+this._subIndex++,g=!1,h=null;try{var i=this._hub.subscribeForClient(this,a,f);g=!0}catch(j){f=null,h=j.message}return c=c||window,g&&(this._subs[f]={h:i,cb:b,sc:c,d:e}),this._invokeOnComplete(d,c,f,g,h),f},OpenAjax.hub.InlineContainer.prototype.publish=function(a,b){this._assertConn(),this._assertPubTopic(a),this._hub.publishForClient(this,a,b)},OpenAjax.hub.InlineContainer.prototype.unsubscribe=function(a,b,c){this._assertConn();if(typeof a=="undefined"||a==null)throw new Error(OpenAjax.hub.Error.BadParameters);var d=this._subs[a];if(!d)throw new Error(OpenAjax.hub.Error.NoSubscription);this._hub.unsubscribeForClient(this,d.h),delete this._subs[a],this._invokeOnComplete(b,c,a,!0)},OpenAjax.hub.InlineContainer.prototype.getSubscriberData=function(a){return this._assertConn(),this._getSubscription(a).d},OpenAjax.hub.InlineContainer.prototype.getSubscriberScope=function(a){return this._assertConn(),this._getSubscription(a).sc},OpenAjax.hub.InlineContainer.prototype._invokeOnComplete=function(a,b,c,d,e){if(a)try{b=b||window,a.call(b,c,d,e)}catch(f){OpenAjax.hub._debugger(),this._client._log("caught error from onComplete callback: "+f.message)}},OpenAjax.hub.InlineContainer.prototype._disconnect=function(){for(var a in this._subs)this._hub.unsubscribeForClient(this,this._subs[a].h);this._subs=[],this._subIndex=1,this._connected=!1},OpenAjax.hub.InlineContainer.prototype._assertConn=function(){if(!this._connected)throw new Error(OpenAjax.hub.Error.Disconnected)},OpenAjax.hub.InlineContainer.prototype._assertPubTopic=function(a){if(a==null||a==""||a.indexOf("*")!=-1||a.indexOf("..")!=-1||a.charAt(0)=="."||a.charAt(a.length-1)==".")throw new Error(OpenAjax.hub.Error.BadParameters)},OpenAjax.hub.InlineContainer.prototype._assertSubTopic=function(a){if(!a)throw new Error(OpenAjax.hub.Error.BadParameters);var b=a.split("."),c=b.length;for(var d=0;d<c;d++){var e=b[d];if(e==""||e.indexOf("*")!=-1&&e!="*"&&e!="**")throw new Error(OpenAjax.hub.Error.BadParameters);if(e=="**"&&d<c-1)throw new Error(OpenAjax.hub.Error.BadParameters)}},OpenAjax.hub.InlineContainer.prototype._getSubscription=function(a){var b=this._subs[a];if(b)return b;throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.InlineHubClient=function(a){if(!a||!a.HubClient||!a.HubClient.onSecurityAlert||!a.InlineHubClient||!a.InlineHubClient.container)throw new Error(OpenAjax.hub.Error.BadParameters);this._params=a,this._onSecurityAlert=a.HubClient.onSecurityAlert,this._scope=a.HubClient.scope||window,this._container=a.InlineHubClient.container;if(a.HubClient.log){var b=this._container.getClientID(),c=this._scope,d=a.HubClient.log;this._log=function(a){d.call(c,"InlineHubClient::"+b+": "+a)},this._doLog=!0}else this._log=function(){}},OpenAjax.hub.InlineHubClient.prototype.connect=function(a,b){this._container.connect(this,a,b)},OpenAjax.hub.InlineHubClient.prototype.disconnect=function(a,b){this._container.disconnect(this,a,b)},OpenAjax.hub.InlineHubClient.prototype.getPartnerOrigin=function(){return this._container.getPartnerOrigin()},OpenAjax.hub.InlineHubClient.prototype.getClientID=function(){return this._container.getClientID()},OpenAjax.hub.InlineHubClient.prototype.subscribe=function(a,b,c,d,e){return this._container.subscribe(a,b,c,d,e)},OpenAjax.hub.InlineHubClient.prototype.publish=function(a,b){this._container.publish(a,b)},OpenAjax.hub.InlineHubClient.prototype.unsubscribe=function(a,b,c){this._container.unsubscribe(a,b,c)},OpenAjax.hub.InlineHubClient.prototype.isConnected=function(){return this._container.isConnected()},OpenAjax.hub.InlineHubClient.prototype.getScope=function(){return this._scope},OpenAjax.hub.InlineHubClient.prototype.getSubscriberData=function(a){return this._container.getSubscriberData(a)},OpenAjax.hub.InlineHubClient.prototype.getSubscriberScope=function(a){return this._container.getSubscriberScope(a)},OpenAjax.hub.InlineHubClient.prototype.getParameters=function(){return this._params},typeof OpenAjax=="undefined"&&(OpenAjax={hub:{}}),OpenAjax.hub.IframeContainer=function(a,b,c){if(!a||!b||!c||!c.Container||!c.Container.onSecurityAlert||!c.IframeContainer||!c.IframeContainer.parent||!c.IframeContainer.uri||!c.IframeContainer.tunnelURI)throw new Error(OpenAjax.hub.Error.BadParameters);this._params=c,this._id=b,window.postMessage?this._delegate=new OpenAjax.hub.IframePMContainer(this,a,b,c):this._delegate=new OpenAjax.hub.IframeFIMContainer(this,a,b,c),this._iframe=this._createIframe(c.IframeContainer.parent,this._delegate.getURI(),c.IframeContainer.iframeAttrs),a.addContainer(this)},OpenAjax.hub.IframeContainer.prototype.getHub=function(){return this._delegate.getHub()},OpenAjax.hub.IframeContainer.prototype.sendToClient=function(a,b,c){this._delegate.sendToClient(a,b,c)},OpenAjax.hub.IframeContainer.prototype.remove=function(){this._delegate.remove(),this._iframe.parentNode.removeChild(this._iframe)},OpenAjax.hub.IframeContainer.prototype.isConnected=function(){return this._delegate.isConnected()},OpenAjax.hub.IframeContainer.prototype.getClientID=function(){return this._id},OpenAjax.hub.IframeContainer.prototype.getPartnerOrigin=function(){return this._delegate.getPartnerOrigin()},OpenAjax.hub.IframeContainer.prototype.getParameters=function(){return this._params},OpenAjax.hub.IframeContainer.prototype.getIframe=function(){return this._iframe},OpenAjax.hub.IframeContainer.bind=function(a,b){var c=b;return function(){return c.apply(a,arguments)}},OpenAjax.hub.IframeContainer.prototype._createIframe=function(a,b,c){var d=document.createElement("iframe");if(c)for(var e in c)if(e=="style")for(var f in c.style)d.style[f]=c.style[f];else d[e]=c[e];return d.style.visibility="hidden",d.src='javascript:"<html></html>"',a.appendChild(d),d.src=b,d},OpenAjax.hub.IframeHubClient=function(a){if(!a||!a.HubClient||!a.HubClient.onSecurityAlert)throw new Error(OpenAjax.hub.Error.BadParameters);this._params=a,window.postMessage?this._delegate=new OpenAjax.hub.IframePMHubClient(this,a):this._delegate=new OpenAjax.hub.IframeFIMHubClient(this,a)},OpenAjax.hub.IframeHubClient.prototype.connect=function(a,b){b=b||window;if(this.isConnected())throw new Error(OpenAjax.hub.Error.Duplicate);this._delegate.connect(a,b)},OpenAjax.hub.IframeHubClient.prototype.disconnect=function(a,b){b=b||window;if(!this.isConnected())throw new Error(OpenAjax.hub.Error.Disconnected);this._delegate.disconnect(a,b)},OpenAjax.hub.IframeHubClient.prototype.getPartnerOrigin=function(){return this._delegate.getPartnerOrigin()},OpenAjax.hub.IframeHubClient.prototype.getClientID=function(){return this._delegate.getClientID()},OpenAjax.hub.IframeHubClient.prototype.subscribe=function(a,b,c,d,e){this._assertConn(),this._assertSubTopic(a);if(!b)throw new Error(OpenAjax.hub.Error.BadParameters);return c=c||window,this._delegate.subscribe(a,b,c,d,e)},OpenAjax.hub.IframeHubClient.prototype.publish=function(a,b){this._assertConn(),this._assertPubTopic(a),this._delegate.publish(a,b)},OpenAjax.hub.IframeHubClient.prototype.unsubscribe=function(a,b,c){this._assertConn();if(typeof a=="undefined"||a==null)throw new Error(OpenAjax.hub.Error.BadParameters);c=c||window,this._delegate.unsubscribe(a,b,c)},OpenAjax.hub.IframeHubClient.prototype.isConnected=function(){return this._delegate.isConnected()},OpenAjax.hub.IframeHubClient.prototype.getScope=function(){return this._delegate.getScope()},OpenAjax.hub.IframeHubClient.prototype.getSubscriberData=function(a){return this._assertConn(),this._delegate.getSubscriberData(a)},OpenAjax.hub.IframeHubClient.prototype.getSubscriberScope=function(a){return this._assertConn(),this._delegate.getSubscriberScope(a)},OpenAjax.hub.IframeHubClient.prototype.getParameters=function(){return this._params},OpenAjax.hub.IframeHubClient.prototype._assertConn=function(){if(!this.isConnected())throw new Error(OpenAjax.hub.Error.Disconnected)},OpenAjax.hub.IframeHubClient.prototype._assertSubTopic=function(a){if(!a)throw new Error(OpenAjax.hub.Error.BadParameters);var b=a.split("."),c=b.length;for(var d=0;d<c;d++){var e=b[d];if(e==""||e.indexOf("*")!=-1&&e!="*"&&e!="**")throw new Error(OpenAjax.hub.Error.BadParameters);if(e=="**"&&d<c-1)throw new Error(OpenAjax.hub.Error.BadParameters)}},OpenAjax.hub.IframeHubClient.prototype._assertPubTopic=function(a){if(a==null||a==""||a.indexOf("*")!=-1||a.indexOf("..")!=-1||a.charAt(0)=="."||a.charAt(a.length-1)==".")throw new Error(OpenAjax.hub.Error.BadParameters)},OpenAjax.hub.IframePMContainer=function(a,b,c,d){this._container=a,this._hub=b,this._id=c,this._onSecurityAlert=d.Container.onSecurityAlert,this._onConnect=d.Container.onConnect?d.Container.onConnect:null,this._onDisconnect=d.Container.onDisconnect?d.Container.onDisconnect:null,this._scope=d.Container.scope||window,this._uri=d.IframeContainer.uri,this._tunnelURI=d.IframeContainer.tunnelURI,this._timeout=d.IframeContainer.timeout||15e3;if(d.Container.log){var e=this._scope,f=d.Container.log;this._log=function(a){f.call(e,"IframeContainer::"+c+": "+a)},this._doLog=!0}else this._log=function(){};this._securityToken=this._generateSecurityToken(d),this._connected=!1,this._subs={},typeof OpenAjax.hub.IframePMContainer._pmCapabilities=="undefined"&&this._testPostMessage(),OpenAjax.hub.IframePMContainer._pmCapabilities.indexOf("s")==-1?this._postMessage=function(a,b,c){a.postMessage(b,c)}:this._postMessage=function(a,b,c){setTimeout(function(){a.postMessage(b,c)},0)},OpenAjax.hub.IframePMContainer._pmListener||(OpenAjax.hub.IframePMContainer._pmListener=new OpenAjax.hub.IframePMContainer.PMListener),this._internalID=OpenAjax.hub.IframePMContainer._pmListener.addContainer(this),this._startLoadTimer()},OpenAjax.hub.IframePMContainer.protocolID="openajax-2.0",OpenAjax.hub.IframePMContainer._pmListener=null,OpenAjax.hub.IframePMContainer.prototype.getHub=function(){return this._hub},OpenAjax.hub.IframePMContainer.prototype.sendToClient=function(a,b,c){this._sendMessage("pub",{t:a,d:b,s:c})},OpenAjax.hub.IframePMContainer.prototype.remove=function(){this._disconnect(),OpenAjax.hub.IframePMContainer._pmListener.removeContainer(this._internalID),clearTimeout(this._loadTimer)},OpenAjax.hub.IframePMContainer.prototype.isConnected=function(){return this._connected},OpenAjax.hub.IframePMContainer.prototype.getPartnerOrigin=function(){return this._connected?this._partnerOriginNoPort:null},OpenAjax.hub.IframePMContainer.prototype.receiveMessage=function(a,b){if(b.t!=this._securityToken||typeof this._partnerOrigin!="undefined"&&!OpenAjax.hub.IframePMContainer.originMatches(this,a)){this._invokeSecurityAlert(OpenAjax.hub.SecurityAlert.ForgedMsg);return}this._doLog&&this._log("received message: ["+a.data+"]");switch(b.m){case"sub":var c="";try{this._subs[b.p.s]=this._hub.subscribeForClient(this._container,b.p.t,b.p.s)}catch(d){c=d.message}this._sendMessage("sub_ack",{s:b.p.s,e:c});break;case"pub":this._hub.publishForClient(this._container,b.p.t,b.p.d);break;case"uns":var e=this._subs[b.p.s];this._hub.unsubscribeForClient(this._container,e),delete this._subs[b.p.s],this._sendMessage("uns_ack",b.p.s);break;case"dis":this._startLoadTimer(),this._disconnect(),this._sendMessage("dis_ack",null);if(this._onDisconnect)try{this._onDisconnect.call(this._scope,this._container)}catch(d){OpenAjax.hub._debugger(),this._log("caught error from onDisconnect callback to constructor: "+d.message)}}},OpenAjax.hub.IframePMContainer.prototype.connect=function(a,b,c){this._log("client connecting to container "+this._id+" :: origin = "+a+" :: securityToken = "+b);if(b!=this._securityToken){this._invokeSecurityAlert(OpenAjax.hub.SecurityAlert.ForgedMsg);return}var d=this;c.onunload=function(){d.isConnected()&&setTimeout(function(){d._invokeSecurityAlert(OpenAjax.hub.SecurityAlert.FramePhish)},1)},clearTimeout(this._loadTimer),this._iframe=this._container.getIframe(),this._iframe.style.visibility="visible",this._partnerOrigin=a,this._partnerOriginNoPort=(new RegExp("^([a-zA-Z]+://[^:]+).*")).exec(this._partnerOrigin)[1],OpenAjax.hub.IframePMContainer._pmCapabilities.indexOf("d")!=-1&&(this._partnerDomain=(new RegExp("^.+://([^:]+).*")).exec(this._partnerOrigin)[1]),this._sendMessage("con_ack",null),this._connected=!0;if(this._onConnect)try{this._onConnect.call(this._scope,this._container)}catch(e){OpenAjax.hub._debugger(),this._log("caught error from onConnect callback to constructor: "+e.message)}},OpenAjax.hub.IframePMContainer.prototype.getURI=function(){var a="oahpv="+encodeURIComponent(OpenAjax.hub.IframePMContainer.protocolID)+"&oahi="+encodeURIComponent(this._internalID)+"&oaht="+this._securityToken+"&oahu="+encodeURIComponent(this._tunnelURI)+"&oahpm="+OpenAjax.hub.IframePMContainer._pmCapabilities;this._id!==this._internalID&&(a+="&oahj="+this._internalID),a+=OpenAjax.hub.enableDebug?"&oahd=true":"";var b=this._uri.split("#");return b[0]=b[0]+(b[0].indexOf("?")!=-1?"&":"?")+a,b.length==1?b[0]:b[0]+"#"+b[1]},OpenAjax.hub.IframePMContainer.originMatches=function(a,b){return b.origin?b.origin==a._partnerOrigin:b.domain==a._partnerDomain},OpenAjax.hub.IframePMContainer.prototype._generateSecurityToken=function(a){if(!OpenAjax.hub.IframePMContainer._prng){var b=(new Date).getTime()+Math.random()+document.cookie;OpenAjax.hub.IframePMContainer._prng=smash.crypto.newPRNG(b)}if(a.IframeContainer.seed)try{var c=a.IframeContainer.seed.call(this._scope);OpenAjax.hub.IframePMContainer._prng.addSeed(c)}catch(d){OpenAjax.hub._debugger(),this._log("caught error from 'seed' callback: "+d.message)}var e=a.IframeContainer.tokenLength||6;return OpenAjax.hub.IframePMContainer._prng.nextRandomB64Str(e)},OpenAjax.hub.IframePMContainer.prototype._testPostMessage=function(){function b(b){b.data=="postmessage.test"&&(a=!0,typeof b.origin=="undefined"&&(OpenAjax.hub.IframePMContainer._pmCapabilities+="d"))}OpenAjax.hub.IframePMContainer._pmCapabilities="";var a=!1;window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent&&window.attachEvent("onmessage",b),window.postMessage("postmessage.test","*"),a&&(OpenAjax.hub.IframePMContainer._pmCapabilities+="s"),window.removeEventListener?window.removeEventListener("message",b,!1):window.detachEvent("onmessage",b)},OpenAjax.hub.IframePMContainer.prototype._startLoadTimer=function(){var a=this;this._loadTimer=setTimeout(function(){OpenAjax.hub.IframePMContainer._pmListener.removeContainer(a._internalID),a._invokeSecurityAlert(OpenAjax.hub.SecurityAlert.LoadTimeout)},this._timeout)},OpenAjax.hub.IframePMContainer.prototype._sendMessage=function(a,b){var c=JSON.stringify({m:a,i:this._internalID,t:this._securityToken,p:b});this._postMessage(this._iframe.contentWindow,c,this._partnerOrigin)},OpenAjax.hub.IframePMContainer.prototype._disconnect=function(){if(this._connected){this._connected=!1,this._iframe.style.visibility="hidden";for(var a in this._subs)this._hub.unsubscribeForClient(this._container,this._subs[a]);this._subs={}}},OpenAjax.hub.IframePMContainer.prototype._invokeSecurityAlert=function(a){try{this._onSecurityAlert.call(this._scope,this._container,a)}catch(b){OpenAjax.hub._debugger(),this._log("caught error from onSecurityAlert callback to constructor: "+b.message)}},OpenAjax.hub.IframePMContainer.PMListener=function(){this._containers={},window.addEventListener?window.addEventListener("message",OpenAjax.hub.IframeContainer.bind(this,this._receiveMessage),!1):window.attachEvent&&window.attachEvent("onmessage",OpenAjax.hub.IframeContainer.bind(this,this._receiveMessage))},OpenAjax.hub.IframePMContainer.PMListener.prototype.addContainer=function(a){var b=a._id;while(this._containers[b])b=(32767*Math.random()|0).toString(16)+"_"+b;return this._containers[b]=a,b},OpenAjax.hub.IframePMContainer.PMListener.prototype.removeContainer=function(a){delete this._containers[a]},OpenAjax.hub.IframePMContainer.PMListener.prototype.connectFromTunnel=function(a,b,c,d){this._containers[a]&&this._containers[a].connect(b,c,d)},OpenAjax.hub.IframePMContainer.PMListener.prototype._receiveMessage=function(a){try{var b=JSON.parse(a.data)}catch(c){return}if(!this._verifyMsg(b))return;if(this._containers[b.i])var d=this._containers[b.i].receiveMessage(a,b)},OpenAjax.hub.IframePMContainer.PMListener.prototype._verifyMsg=function(a){return typeof a.m=="string"&&typeof a.i=="string"&&"t"in a&&"p"in a},OpenAjax.hub.IframePMHubClient=function(a,b){this._checkProtocolID(),this._client=a,this._onSecurityAlert=b.HubClient.onSecurityAlert,this._scope=b.HubClient.scope||window,this._id=OpenAjax.hub.IframePMHubClient.queryURLParam("oahi"),this._internalID=OpenAjax.hub.IframePMHubClient.queryURLParam("oahj")||this._id,this._securityToken=OpenAjax.hub.IframePMHubClient.queryURLParam("oaht"),this._tunnelURI=OpenAjax.hub.IframePMHubClient.queryURLParam("oahu"),OpenAjax.hub.IframePMContainer._pmCapabilities=OpenAjax.hub.IframePMHubClient.queryURLParam("oahpm");if(!this._id||!this._securityToken||!this._tunnelURI)throw new Error(OpenAjax.hub.Error.WrongProtocol);OpenAjax.hub.IframePMHubClient.queryURLParam("oahd")&&(OpenAjax.hub.enableDebug=!0),this._partnerOrigin=(new RegExp("^([a-zA-Z]+://[^/?#]+).*")).exec(this._tunnelURI)[1],this._partnerOriginNoPort=(new RegExp("^([a-zA-Z]+://[^:]+).*")).exec(this._partnerOrigin)[1],OpenAjax.hub.IframePMContainer._pmCapabilities.indexOf("d")!=-1&&(this._partnerDomain=(new RegExp("^.+://([^:]+).*")).exec(this._partnerOrigin)[1]);if(b.HubClient.log){var c=this._id,d=this._scope,e=b.HubClient.log;this._log=function(a){e.call(d,"IframeHubClient::"+c+": "+a)},this._doLog=!0}else this._log=function(){};this._connected=!1,this._subs={},this._subIndex=1,OpenAjax.hub.IframePMContainer._pmCapabilities.indexOf("s")==-1?this._postMessage=function(a,b,c){a.postMessage(b,c)}:this._postMessage=function(a,b,c){setTimeout(function(){a.postMessage(b,c)},0)}},OpenAjax.hub.IframePMHubClient.protocolID="openajax-2.0",OpenAjax.hub.IframePMHubClient.prototype.connect=function(a,b){a&&(this._connectOnComplete={cb:a,sc:b}),this._msgListener=OpenAjax.hub.IframeContainer.bind(this,this._receiveMessage),window.addEventListener?window.addEventListener("message",this._msgListener,!1):window.attachEvent&&window.attachEvent("onmessage",this._msgListener);var c=window.location.protocol+"//"+window.location.host,d=document.createElement("iframe");document.body.appendChild(d),d.src=this._tunnelURI+(this._tunnelURI.indexOf("?")==-1?"?":"&")+"oahj="+encodeURIComponent(this._internalID)+"&oaht="+this._securityToken+"&oaho="+encodeURIComponent(c),d.style.position="absolute",d.style.left=d.style.top="-10px",d.style.height=d.style.width="1px",d.style.visibility="hidden",this._tunnelIframe=d},OpenAjax.hub.IframePMHubClient.prototype.disconnect=function(a,b){this._connected=!1,a&&(this._disconnectOnComplete={cb:a,sc:b}),this._sendMessage("dis",null)},OpenAjax.hub.IframePMHubClient.prototype.getPartnerOrigin=function(){return this._connected?(new RegExp("^([a-zA-Z]+://[^:]+).*")).exec(this._partnerOrigin)[1]:null},OpenAjax.hub.IframePMHubClient.prototype.getClientID=function(){return this._id},OpenAjax.hub.IframePMHubClient.prototype.subscribe=function(a,b,c,d,e){var f=""+this._subIndex++;return this._subs[f]={cb:b,sc:c,d:e,oc:d},this._sendMessage("sub",{t:a,s:f}),f},OpenAjax.hub.IframePMHubClient.prototype.publish=function(a,b){this._sendMessage("pub",{t:a,d:b})},OpenAjax.hub.IframePMHubClient.prototype.unsubscribe=function(a,b,c){if(!this._subs[a]||this._subs[a].uns)throw new Error(OpenAjax.hub.Error.NoSubscription);this._subs[a].uns={cb:b,sc:c},this._sendMessage("uns",{s:a})},OpenAjax.hub.IframePMHubClient.prototype.isConnected=function(){return this._connected},OpenAjax.hub.IframePMHubClient.prototype.getScope=function(){return this._scope},OpenAjax.hub.IframePMHubClient.prototype.getSubscriberData=function(a){var b=this._subs[a];if(b)return b.d;throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.IframePMHubClient.prototype.getSubscriberScope=function(a){var b=this._subs[a];if(b)return b.sc;throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.IframePMHubClient.queryURLParam=function(a){var b=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(window.location.search);return b?decodeURIComponent(b[1].replace(/\+/g,"%20")):null},OpenAjax.hub.IframePMHubClient.prototype._checkProtocolID=function(){var a=OpenAjax.hub.IframePMHubClient.queryURLParam("oahpv");if(a!=OpenAjax.hub.IframePMHubClient.protocolID)throw new Error(OpenAjax.hub.Error.WrongProtocol)},OpenAjax.hub.IframePMHubClient.prototype._receiveMessage=function(a){try{var b=JSON.parse(a.data)}catch(c){return}if(!this._verifyMsg(b))return;if(b.i!=this._internalID)return;if(!OpenAjax.hub.IframePMContainer.originMatches(this,a)||b.t!=this._securityToken){try{this._onSecurityAlert.call(this._scope,this._client,OpenAjax.hub.SecurityAlert.ForgedMsg)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onSecurityAlert callback to constructor: "+c.message)}return}this._doLog&&this._log("received message: ["+a.data+"]");switch(b.m){case"sub_ack":var d=b.p.s,e=this._subs[d].oc;if(e)try{delete this._subs[d].oc;var f=this._subs[d].sc;e.call(f,b.p.s,b.p.e=="",b.p.e)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onComplete callback to HubClient.subscribe(): "+c.message)}break;case"pub":var d=b.p.s;if(this._subs[d]&&!this._subs[d].uns){var g=this._subs[d].cb,f=this._subs[d].sc,h=this._subs[d].d;try{g.call(f,b.p.t,b.p.d,h)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onData callback to HubClient.subscribe(): "+c.message)}}break;case"uns_ack":var d=b.p;if(this._subs[d]){var e=this._subs[d].uns.cb;if(e)try{var f=this._subs[d].uns.sc;e.call(f,d,!0)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onComplete callback to HubClient.unsubscribe(): "+c.message)}delete this._subs[d]}break;case"con_ack":this._connected=!0;if(this._connectOnComplete){var e=this._connectOnComplete.cb,f=this._connectOnComplete.sc;try{e.call(f,this._client,!0)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onComplete callback to HubClient.connect(): "+c.message)}delete this._connectOnComplete}break;case"dis_ack":window.removeEventListener?window.removeEventListener("message",this._msgListener,!1):window.detachEvent("onmessage",this._msgListener),delete this._msgListener,this._tunnelIframe.parentNode.removeChild(this._tunnelIframe),delete this._tunnelIframe;if(this._disconnectOnComplete){try{var e=this._disconnectOnComplete.cb,f=this._disconnectOnComplete.sc;e.call(f,this._client,!0)}catch(c){OpenAjax.hub._debugger(),this._log("caught error from onComplete callback to HubClient.disconnect(): "+c.message)}delete this._disconnectOnComplete}}},OpenAjax.hub.IframePMHubClient.prototype._verifyMsg=function(a){return typeof a.m=="string"&&"t"in a&&"p"in a},OpenAjax.hub.IframePMHubClient.prototype._sendMessage=function(a,b){var c=JSON.stringify({m:a,i:this._internalID,t:this._securityToken,p:b});this._postMessage(window.parent,c,this._partnerOrigin)},typeof OpenAjax=="undefined"&&(OpenAjax={hub:{}}),OpenAjax.hub.IframeFIMContainer=function(a,b,c,d){this._container=a,this._hub=b,this._onSecurityAlert=d.Container.onSecurityAlert,this._onConnect=d.Container.onConnect?d.Container.onConnect:null,this._onDisconnect=d.Container.onDisconnect?d.Container.onDisconnect:null,this._scope=d.Container.scope||window,this._clientURI=d.IframeContainer.uri,smash.SEComm.tunnelURI=d.IframeContainer.tunnelURI,smash._loadTimeout=d.IframeContainer.timeout||15e3;if(d.Container.log){var e=this._scope,f=d.Container.log;this._log=function(a){f.call(e,"IframeContainer::"+c+": "+a)},this._doLog=!0}else this._log=function(){};smash._createPRNG(this,d),smash._ensureSingletonManager(),this._internalID=smash._singletonManager.generateUniqueClientName(c)},OpenAjax.hub.IframeFIMContainer.prototype.getHub=function(){return this._hub},OpenAjax.hub.IframeFIMContainer.prototype.sendToClient=function(a,b,c){smash._singletonManager.sendToClient(this._internalID,a,b,[c])},OpenAjax.hub.IframeFIMContainer.prototype.remove=function(){return smash._singletonManager.prepareForUnload(this._internalID)},OpenAjax.hub.IframeFIMContainer.prototype.isConnected=function(){return smash._singletonManager.isConnected(this._internalID)},OpenAjax.hub.IframeFIMContainer.prototype.getPartnerOrigin=function(){return smash._singletonManager.getPartnerOrigin(this._internalID)},OpenAjax.hub.IframeFIMContainer.prototype.getURI=function(){function b(b,c){var d=null;switch(c){case smash.SecurityErrors.INVALID_TOKEN:case smash.SecurityErrors.TOKEN_VERIFICATION_FAILED:d=OpenAjax.hub.SecurityAlert.ForgedMsg;break;case smash.SecurityErrors.TUNNEL_UNLOAD:d=OpenAjax.hub.SecurityAlert.FramePhish;break;case smash.SecurityErrors.COMPONENT_LOAD:d=OpenAjax.hub.SecurityAlert.LoadTimeout}try{a._onSecurityAlert.call(a._scope,a._container,d)}catch(e){OpenAjax.hub._debugger(),a._log("caught error from onSecurityAlert callback to constructor: "+e.message)}}var a=this,c=smash._singletonManager.prepareForLoad({clientName:this._internalID,uri:this._clientURI,commErrorCallback:b,oaaContainer:this,log:this._log});return c&&OpenAjax.hub.enableDebug&&(c+=":debug"),c},OpenAjax.hub.IframeFIMHubClient=function(a,b){var c=(new RegExp("[\\?&]oahm=([^&#]*)")).exec(window.location.search);if(!c)throw new Error(OpenAjax.hub.Error.WrongProtocol);c=c[1];var d=c.split(":",1);if(d[0]!=smash._protocolID)throw new Error(OpenAjax.hub.Error.WrongProtocol);c=c.substring(d[0].length+1);var e=window.location.href+"#"+c;window.location.replace(e),this._client=a,this._onSecurityAlert=b.HubClient.onSecurityAlert,this._scope=b.HubClient.scope||window;var f=new RegExp("\\d{3}.{"+smash._securityTokenLength+"}.{"+smash._securityTokenLength+"}\\d{3}(.*)"),g=f.exec(c)[1],h=g.split(":"),i=decodeURIComponent(h[0]);this._id=i.substring(i.indexOf("_")+1),h[2]&&h[2]=="debug"&&(OpenAjax.hub.enableDebug=!0);if(b.HubClient.log){var j=this._id,k=this._scope,l=b.HubClient.log;this._log=function(a){l.call(k,"IframeHubClient::"+j+": "+a)},this._doLog=!0}else this._log=function(){};this._connected=!1,this._subs={},this._subIndex=1,smash._createPRNG(this,b)},OpenAjax.hub.IframeFIMHubClient.prototype.connect=function(a,b){function d(d,e){d&&(c._connected=!0);if(a)try{a.call(b,c._client,d)}catch(f){OpenAjax.hub._debugger(),c._log("caught error from onComplete callback to HubClient.connect(): "+f.message)}}if(smash._singletonClientHub==null){smash._singletonClientHub=new smash.SEHubClient(null,this._log);var c=this;smash._singletonClientHub.setSecurityErrorCallback(function(a){a!=smash.SecurityErrors.INVALID_TOKEN&&c._log("unknown smash security error: "+a);try{c._onSecurityAlert.call(c._scope,c._client,OpenAjax.hub.SecurityAlert.ForgedMsg)}catch(b){OpenAjax.hub._debugger(),c._log("caught error from onSecurityAlert callback to constructor: "+b.message)}})}var c=this;smash._singletonClientHub.connect(d)},OpenAjax.hub.IframeFIMHubClient.prototype.disconnect=function(a,b){function d(d,e){if(a)try{a.call(b,c._client,d)}catch(f){OpenAjax.hub._debugger(),c._log("caught error from onComplete callback to HubClient.disconnect(): "+f.message)}}this._connected=!1;var c=this;smash._singletonClientHub.disconnect(d)},OpenAjax.hub.IframeFIMHubClient.prototype.getPartnerOrigin=function(){return smash._singletonClientHub?smash._singletonClientHub.getPartnerOrigin():null},OpenAjax.hub.IframeFIMHubClient.prototype.getClientID=function(){return this._id},OpenAjax.hub.IframeFIMHubClient.prototype.subscribe=function(a,b,c,d,e){function i(a,d,f){try{b.call(c,d,f,e)}catch(h){OpenAjax.hub._debugger(),g._log("caught error from onData callback to HubClient.subscribe(): "+h.message)}}var f=""+this._subIndex++,g=this,h=d?function(a,b,e){try{d.call(c,f,a,e)}catch(h){OpenAjax.hub._debugger(),g._log("caught error from onComplete callback to HubClient.subscribe(): "+h.message)}}:null;return this._subs[f]=smash._singletonClientHub.subscribe(a,h,i,c,e),f},OpenAjax.hub.IframeFIMHubClient.prototype.publish=function(a,b){smash._singletonClientHub.publish(a,b)},OpenAjax.hub.IframeFIMHubClient.prototype.unsubscribe=function(a,b,c){function e(e,f){delete d._subs[a];if(b)try{b.call(c,a,e)}catch(g){OpenAjax.hub._debugger(),d._log("caught error from onComplete callback to HubClient.unsubscribe(): "+g.message)}}if(!this._subs[a])throw new Error(OpenAjax.hub.Error.NoSubscription);var d=this;this._subs[a].unsubscribe(e)},OpenAjax.hub.IframeFIMHubClient.prototype.isConnected=function(){return this._connected},OpenAjax.hub.IframeFIMHubClient.prototype.getScope=function(){return this._scope},OpenAjax.hub.IframeFIMHubClient.prototype.getSubscriberData=function(a){var b=this._subs[a];if(b)return b.getSubscriberData();throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.IframeFIMHubClient.prototype.getSubscriberScope=function(a){var b=this._subs[a];if(b)return b.getSubscriberScope();throw new Error(OpenAjax.hub.Error.NoSubscription)};if(typeof smash=="undefined")var smash={};smash._singletonManager=undefined,smash._singletonClientHub=undefined,smash._protocolID="openajax-2.0",smash._prng=undefined,smash._securityTokenLength=6,smash._securityTokenOverhead=null,smash._computeOtherTokenConstants=function(){smash._securityTokenOverhead=2*smash._securityTokenLength,smash._multiplier=Math.pow(10,smash._securityTokenLength-1)},smash._computeOtherTokenConstants(),smash._createPRNG=function(a,b){if(!smash._prng){var c=(new Date).getTime()+Math.random()+document.cookie;smash._prng=smash.crypto.newPRNG(c)}var d=b.IframeContainer||b.IframeHubClient;if(d&&d.seed)try{var e=d.seed.call(a._scope);smash._prng.addSeed(e)}catch(f){OpenAjax.hub._debugger(),a._log("caught error from 'seed' callback: "+f.message)}},smash._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",smash._generateSecurityToken=function(){var a;if(smash._prng)a=smash._prng.nextRandomB64Str(smash._securityTokenLength);else{var b=Math.random();a="";for(var c=0;c<smash._securityTokenLength;c++){var d=b*64,e=Math.floor(d);b=d-e,a+=smash._keyStr.charAt(e)}}return a},smash._ensureSingletonManager=function(){smash._singletonManager==null&&(smash._singletonManager=new smash.SEHub)},smash.SEHub=function(){function b(a,b){this.uri=a,this.connected=!1,this.errorCallback=b}function c(b,c){var d=a.componentInfo[c];if(d!=null){var e=d.errorCallback;e!=null&&e(c,b)}}var a=this;this.componentInfo=[],this._subs=[],this.generateUniqueClientName=function(b){do b=(32767*Math.random()|0).toString(16)+"_"+b;while(a.componentInfo[b]);return b},this.prepareForLoad=function(d){var e=d.clientName,f=d.uri;return e==null||f==null?null:a.componentInfo[e]!=null?null:(a.componentInfo[e]=new b(f,d.commErrorCallback),a.componentInfo[e].seComm=new smash.SEComm,a.componentInfo[e].seComm.setSecurityListener(c),a.componentInfo[e].oaaContainer=d.oaaContainer,a.componentInfo[e].seComm.prepareForLoad(e,f,a,smash._loadTimeout,d.log))},this.prepareForUnload=function(b){return a.componentInfo[b]?(a._disconnect(b),a.componentInfo[b].seComm.prepareForUnload(),delete a.componentInfo[b],!0):!0},this.isConnected=function(b){return a.componentInfo[b]&&a.componentInfo[b].connected?!0:!1},this.sendToClient=function(b,c,d,e){if(a.isConnected(b)){var f=a.componentInfo[b].seComm;f&&f.distribute(c,e,d)}},this.componentLoaded=function(b,c){if(a.componentInfo[b]){a.componentInfo[b].connected=!0,a.componentInfo[b].partnerOrigin=(new RegExp("^([a-zA-Z]+://[^:/?#]+).*")).exec(c)[1];var d=a.componentInfo[b].oaaContainer;d._container.getIframe().style.visibility="visible";if(d._onConnect)try{d._onConnect.call(d._scope,d._container)}catch(e){OpenAjax.hub._debugger(),d._log("caught error from onConnect callback to constructor: "+e.message)}}},this.publishInternal=function(b,c,d){if(a.componentInfo[b]){var e=a.componentInfo[b].oaaContainer;e._hub.publishForClient(e._container,c,d)}},this.subscribeInternal=function(b,c,d){var e=a.componentInfo[b].oaaContainer;a._subs[c]=e._hub.subscribeForClient(e._container,d,c)},this.unsubscribeInternal=function(b,c){try{var d=a._subs[c],e=a.componentInfo[b].oaaContainer;return e._hub.unsubscribeForClient(e._container,d),!0}catch(f){}return!1},this.disconnect=function(b){a._disconnect(b);var c=a.componentInfo[b].oaaContainer;if(c._onDisconnect)try{c._onDisconnect.call(c._scope,c._container)}catch(d){OpenAjax.hub._debugger(),c._log("caught error from onDisconnect callback to constructor: "+d.message)}},this._disconnect=function(b){if(a.componentInfo[b].connected){a.componentInfo[b].connected=!1;var c=a.componentInfo[b].oaaContainer;c._container.getIframe().style.visibility="hidden";for(var d in a._subs)c._hub.unsubscribeForClient(c._container,a._subs[d]);a._subs=[]}},this.getPartnerOrigin=function(b){return a.componentInfo[b].connected?a.componentInfo[b].partnerOrigin:null}},smash.SEHubClient=function(a,b){function c(a,b,c,d,e,f,g){var h=!1,i=g,j=f,k=this;this.getTopic=function(){return b},this.getConnHandle=function(){return e},this.equals=function(b){return b._getSubId!=null&&typeof b._getSubId=="function"&&b.getConnHandle!=null&&typeof b.getConnHandle=="function"&&a===b._getSubId()&&e===b.getConnHandle()?!0:!1},this.isSubscribed=function(){return h},this.unsubscribe=function(a){return e._unsubscribe(k,a)},this.getSubscriberData=function(){return i},this.getSubscriberScope=function(){return j},this._getSubId=function(){return a},this._setIsSubscribed=function(a){h=a},this._getCallback=function(){return c},this._getEventCallback=function(){return d}}function l(a){if(!h&&a.type!=smash.SECommMessage.CONNECT_ACK)return;switch(a.type){case smash.SECommMessage.DISTRIBUTE:if(a.additionalHeader!=null&&a.additionalHeader.s!=null){var b=a.additionalHeader.s;for(var c=0;c<b.length;c++){var d=b[c];if(d!=null&&f[d]!=null){var e=f[d]._getEventCallback();e!=null&&e(f[d],a.topic,a.payload)}}}break;case smash.SECommMessage.SUBSCRIBE_ACK:if(a.additionalHeader!=null){var d=a.additionalHeader.subId,g=a.additionalHeader.isOk,i=a.additionalHeader.err;if(d!=null&&g!=null&&f[d]!=null){var l=f[d]._getCallback();g?(f[d]._setIsSubscribed(!0),l!=null&&l(!0,f[d])):(l!=null&&l(!1,f[d],i),f[d]=undefined)}}break;case smash.SECommMessage.CONNECT_ACK:j(!0);break;case smash.SECommMessage.DISCONNECT_ACK:k(!0)}}function m(a){if(d==null)throw new Error(errorString);d(a)}this.equals=function(a){return i===a},this.isConnected=function(){return h},this.getClientName=function(){return a},this.connect=function(a){j=function(b){b&&(h=!0),a(b,i)},g.connect(j)},this.disconnect=function(a){k=function(b){b&&(h=!1,f=[]),a(b,i)},g.disconnect();return},this.subscribe=function(a,b,d,h,j){var k=e+"";return e++,f[k]=new c(k,a,b,d,i,h,j),g.subscribe(k,a),f[k]},this.publish=function(a,b){return g.publish(a,b),!0},this.getPartnerOrigin=function(){if(h&&g!=null){var a=g.getParsedTunnelUrl();if(a!=null)return a.scheme+"://"+a.host}return null},this.setSecurityErrorCallback=function(a){d=a},this._unsubscribe=function(a,b){var c=a._getSubId();if(!f[c])throw new Error(OpenAjax.hub.Error.NoSubscription);return f[c]=undefined,g.unsubscribe(c),b!=null&&b(!0,a),a};var d=undefined,e=0,f=[],g=new smash.SECommClient(a,b),h=!1,i=this,j=null,k=null;g.handleIncomingMessage=l,g.setSecurityListener(m)},smash.SecurityErrors={INVALID_TOKEN:0,TOKEN_VERIFICATION_FAILED:1,TUNNEL_UNLOAD:2,COMPONENT_LOAD:3},smash.SECommMessage=function(){this.type=null,this.topic=null,this.additionalHeader=null,this.payload=null;var a="y",b="t",c="h",d="p";this.serialize=function(){var e=a+"="+this.type;if(this.topic!=null){var f=encodeURIComponent(this.topic),g="&"+b+"="+f;e+=g}if(this.additionalHeader!=null){var h=encodeURIComponent(JSON.stringify(this.additionalHeader)),i="&"+c+"="+h;e+=i}if(this.payload!=null){var j=encodeURIComponent(this.payload),k="&"+d+"="+j;e+=k}return e},this.deserialize=function(e){var f=e.split("&");for(var g=0;g<f.length;g++){var h=f[g].split("=");switch(h[0]){case a:this.type=h[1];break;case b:this.topic=decodeURIComponent(h[1]);break;case c:var i=decodeURIComponent(h[1]);this.additionalHeader=JSON.parse(i);break;case d:this.payload=decodeURIComponent(h[1])}}}},smash.SECommMessage.CONNECT="con",smash.SECommMessage.CONNECT_ACK="cac",smash.SECommMessage.DISCONNECT="xcon",smash.SECommMessage.DISCONNECT_ACK="xac",smash.SECommMessage.PUBLISH="pub",smash.SECommMessage.DISTRIBUTE="dis",smash.SECommMessage.SUBSCRIBE="sub",smash.SECommMessage.UNSUBSCRIBE="uns",smash.SECommMessage.SUBSCRIBE_ACK="sac",smash.SECommMessage.ERROR="err",smash.SECommErrors={},smash.SECommErrors.tunnelNotSetError=new Error("The tunnel URI was not set. Please set the tunnel URI."),smash.SEComm=function(){function r(a,b){var c=a.split("?");return c.length>1?c[0]+"?"+b+"&"+c[1]:(c=a.split("#"),c.length>1?c[0]+"?"+b+c[1]:a+"?"+b)}function s(){clearInterval(b),b=null,f||o.handleSecurityError(smash.SecurityErrors.COMPONENT_LOAD)}function t(){clearInterval(d),o.handleSecurityError(smash.SecurityErrors.COMPONENT_LOAD)}function u(a,b){return function(){n(a,b)}}function v(){n==null?setTimeout("throw tunnelUnloadError;",a):setTimeout(u(smash.SecurityErrors.TUNNEL_UNLOAD,h),a)}function w(a){p==0?i.push(a):f.send(a)}var a=1,b=null,c=0,d=null,e=null,f=null,g=null,h=null,i=[],j=null,k=null,l=null,m=null,n=null,o=this,p=!1,q=null;this.setSecurityListener=function(a){n=a},this.prepareForLoad=function(a,d,f,g,i){q=i,this.log("Parent connecting to : "+a),k=f,h=a,c=g;if(smash.SEComm.tunnelURI==null)throw smash.SECommErrors.tunnelNotSetError;return m=smash._generateSecurityToken(),e=r(d,"oahm="+smash._protocolID+":100"+m+m+"000"+encodeURIComponent(a)+":"+encodeURIComponent(smash.SEComm.tunnelURI)),smash.SEComm.instances[a]=o,b=setInterval(s,c),e},this.getScope=function(){return this},this.getCallback=function(){return"messageReceived"},this.initializationFinished=function(a,b,c,d,e){this.log("Tunnel commLib initialization finished. Processing outgoing queue. Security token: "+b);if(m!=b)return o.handleSecurityError(smash.SecurityErrors.TOKEN_VERIFICATION_FAILED),!1;f=a,p=!0,this.log("Token verified."),e.onunload=v,k.componentLoaded(h,c);while(i.length>0)f.send(i.shift());return!0},this.prepareForUnload=function(){b!=null&&(clearInterval(b),b=null)},this.handleSecurityError=function(a){a==smash.SecurityErrors.COMPONENT_LOAD&&(this.initializationFinished=function(){return!1});if(n==null)throw new Error(a);n(a,h);return},this.messageReceived=function(a){var b=new smash.SECommMessage;b.deserialize(a);switch(b.type){case smash.SECommMessage.PUBLISH:if(b.additionalHeader!=null){var e=b.payload;b.additionalHeader.f=="J"&&(e=JSON.parse(b.payload)),k.publishInternal(h,b.topic,e)}break;case smash.SECommMessage.SUBSCRIBE:if(b.additionalHeader!=null){var f=!0,g="";try{k.subscribeInternal(h,b.additionalHeader.subId,b.topic)}catch(i){f=!1,g=i.message}var j=new smash.SECommMessage;j.type=smash.SECommMessage.SUBSCRIBE_ACK,j.additionalHeader={subId:b.additionalHeader.subId,isOk:f,err:g},w(j.serialize())}break;case smash.SECommMessage.UNSUBSCRIBE:b.additionalHeader!=null&&k.unsubscribeInternal(h,b.additionalHeader.subId);break;case smash.SECommMessage.CONNECT:clearInterval(d),k.componentLoaded(h,b.payload);var b=new smash.SECommMessage;b.type=smash.SECommMessage.CONNECT_ACK,w(b.serialize());break;case smash.SECommMessage.DISCONNECT:k.disconnect(h),d=setInterval(t,c);var b=new smash.SECommMessage;b.type=smash.SECommMessage.DISCONNECT_ACK,w(b.serialize())}},this.distribute=function(a,b,c){var d=new smash.SECommMessage;d.type=smash.SECommMessage.DISTRIBUTE,d.topic=a,d.additionalHeader={s:b},typeof c=="string"?(d.additionalHeader.f="S",d.payload=c):(d.additionalHeader.f="J",d.payload=JSON.stringify(c)),w(d.serialize())},this.log=function(a){q(a)}},smash.SEComm.instances=[],smash.SECommClient=function(a,b){function m(a){var b=a.match(l);this.scheme=b[2]==""?null:b[2],this.host=b[4]==""?null:b[4],this.port=b[6]==""?null:b[6],this.path=b[7]==""?null:b[7],this.query=b[8]==""?null:b[8]}function n(a){g==0?f.push(a):d.send(a)}var c=[];c.child=this;var d=new smash.CommLib(!0,c,a),e=this,f=[],g=!1,h=null,i={f:"J"},j={f:"S"},k=null;this.publish=function(a,b){var c=new smash.SECommMessage;c.type=smash.SECommMessage.PUBLISH,c.topic=a,typeof b=="string"?(c.additionalHeader=j,c.payload=b):(c.additionalHeader=i,c.payload=JSON.stringify(b)),n(c.serialize())},this.subscribe=function(a,b){var c=new smash.SECommMessage;c.type=smash.SECommMessage.SUBSCRIBE,c.topic=b,c.additionalHeader={subId:a},n(c.serialize())},this.connect=function(a){if(g){var b=new smash.SECommMessage;b.type=smash.SECommMessage.CONNECT,b.payload=window.location.href.split("#")[0],n(b.serialize());return}connectCallback=a},this.disconnect=function(){var a=new smash.SECommMessage;a.type=smash.SECommMessage.DISCONNECT,n(a.serialize())},this.initializationFinished=function(a){this.log("Initialization finished. Processing outgoing queue."),k=new m(a),g=!0,connectCallback(!0);while(f.length>0)d.send(f.shift())},this.getParsedTunnelUrl=function(){return k};var l=new RegExp("^((http|https):)?(//([^/?#:]*))?(:([0-9]*))?([^?#]*)(\\?([^#]*))?");this.unsubscribe=function(a){var b=new smash.SECommMessage;b.type=smash.SECommMessage.UNSUBSCRIBE,b.additionalHeader={subId:a},n(b.serialize())},this.messageReceived=function(a){var b=new smash.SECommMessage;b.deserialize(a);if(b.type==smash.SECommMessage.DISTRIBUTE){var c=b.additionalHeader;c!=null&&c.f=="J"&&(b.payload=JSON.parse(b.payload))}e.handleIncomingMessage(b)},this.handleSecurityError=function(b){if(h==null)throw new Error(b);h(b,a);return},this.setSecurityListener=function(a){h=a},this.handleIncomingMessage=function(a){alert("SECommClient\n\nTopic: "+a.topic+"\n\nPayload: "+a.payload)},this.log=function(a){b(a)}},smash.CommLib=function(a,b,c){function B(){E()&&F()&&G()&&H(),C()&&M()}function C(){return q.type==e?!0:q.msn==n.ackMsn&&n.ack==1?!0:(P("Waiting for ACK : "+q.msn),!1)}function D(){return u++,u==100&&(u=0),u<10?"0"+u:""+u}function E(){var a=window.location.href.split("#");if(a.length==2){var b=a[1];if(b!=""&&b!=m)return m=b,!0}return!1}function F(){var a=m.substr(0,1),b=m.substr(1,2),c=3,d=m.substr(c,smash._securityTokenLength);c+=smash._securityTokenLength;var e=m.substr(c,smash._securityTokenLength);c+=smash._securityTokenLength;var f=m.substr(c,1);c+=1;var g=m.substr(c,2);c+=2;var h=m.substr(c);return P("In : Type: "+a+" msn: "+b+" tokenParent: "+d+" tokenChild: "+e+" ack: "+f+" msn: "+g+" payload: "+h),n={type:a,msn:b,tokenParent:d,tokenChild:e,ack:f,ackMsn:g,payload:h},!0}function G(){return n.type==d||n.tokenParent==x&&n.tokenChild==y?!0:(P("Security token error: Invalid security token received. The message will be discarded."),O(smash.SecurityErrors.INVALID_TOKEN),!1)}function H(){l=1,n.type!=d&&a&&q.type==d&&n.ack=="1"&&q.msn==n.ackMsn&&z.initializationFinished(r);switch(n.type){case d:I();break;case e:J();break;case f:K();break;case g:L()}o=n}function I(){var e=n.payload.split(":"),f=decodeURIComponent(e[0]);r=decodeURIComponent(e[1]),x=n.tokenParent,y=n.tokenChild;if(a){c!=null&&(f=c),y=smash._generateSecurityToken();var g="3827816c-f3b1-11db-8314-0800200c9a66",i=document.createElement("iframe"),j=encodeURIComponent(window.location.href.split("#")[0]),k=j,m=encodeURIComponent(f)+":"+j+":"+k;r+=(r.indexOf("?")!=-1?"&":"?")+"oahm=100"+x+y+"100"+m,i.src=r,i.name=g,i.id=g,document.body.appendChild(i),i.style.position="absolute",i.style.left=i.style.top="-10px",i.style.height=i.style.width="1px",i.style.visibility="hidden",l=0,s=window.frames[g],q={type:d,msn:"00",tokenParent:x,tokenChild:y,ack:"0",ackMsn:"00",payload:m},z=b.child}else{var k=decodeURIComponent(e[2]);s=window.parent,z=b[f];var o=z.initializationFinished(h,x,r,k,window);o||(l=0),q={type:d,msn:"00",tokenParent:x,tokenChild:y,ack:"0",ackMsn:"00",payload:encodeURIComponent(f)+":"+encodeURIComponent(window.location.href.split("#")[0])}}s==null&&P("Init failed.")}function J(){l=0}function K(){v+=n.payload}function L(){v+=n.payload,P("Received: "+v),z.messageReceived(v),v=""}function M(){t.length==0&&l==1&&t.push({type:e,payload:""}),t.length!=0&&(p=t.shift(),p.tokenParent=x,p.tokenChild=y,p.msn=D(),p.ack="1",p.ackMsn=o.msn,l=0,N())}function N(){var a=r+"#"+p.type+p.msn+p.tokenParent+p.tokenChild+p.ack+p.ackMsn+p.payload;s.location.replace(a),q=p,P("Out: Type: "+p.type+" msn: "+p.msn+" tokenParent: "+p.tokenParent+" tokenChild: "+p.tokenChild+" ack: "+p.ack+" msn: "+p.ackMsn+" payload: "+p.payload)}function O(a){clearInterval(w),z.handleSecurityError(a)}function P(a){if(z){while(A.length>0)z.log(A.shift());z.log(a)}else A.push(a)}var d="1",e="2",f="3",g="4",h=this,i=100,j=4e3,k=6,l=0,m=null,n=null,o=null,p=null,q=null,r=null,s=null,t=[],u=0,v="",w=null,x=null,y=null,z=null,A=[];this.send=function(a){if(r==null){P("Trying to send without proper initialization. Message will be discarded. "+a);return}P("Sending: "+a);var b=a,c=j-k-smash._securityTokenOverhead-r.length,d=b;while(d.length>0){var e=d.substr(0,c);d=d.substr(c),d==0?t.push({type:g,payload:e}):t.push({type:f,payload:e})}},w=setInterval(B,i)};if(typeof smash=="undefined")var smash={};smash.crypto={strToWA:function(a,b){var c=Array(),d=(1<<b)-1;for(var e=0;e<a.length*b;e+=b)c[e>>5]|=(a.charCodeAt(e/b)&d)<<32-b-e%32;return c},hmac_sha1:function(a,b,c){var d=Array(16),e=Array(16);for(var f=0;f<16;f++)d[f]=a[f]^909522486,e[f]=a[f]^1549556828;var g=this.sha1(d.concat(this.strToWA(b,c)),512+b.length*c);return this.sha1(e.concat(g),672)},newPRNG:function(a){function e(a){return that.hmac_sha1(b,a,8)}function f(a){var b=e(a);for(var d=0;d<5;d++)c[d]^=b[d]}that=this,(typeof a!="string"||a.length<12)&&alert("WARNING: Seed length too short ...");var b=[43417,15926,18182,33130,9585,30800,49772,40144,47678,55453,4659,38181,65340,6787,54417,65301],c=[],d=0;return f(a),{addSeed:function(a){f(a)},nextRandomOctets:function(a){var b=[];while(a>0){d+=1;var e=that.hmac_sha1(c,d.toString(16),8);for(i=0;i<20&a>0;i++,a--)b.push((e[i>>2]>>i%4)%256)}return b},nextRandomB64Str:function(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",c=this.nextRandomOctets(a),d="";for(var e=0;e<a;e++)d+=b.charAt(c[e]&63);return d}}},sha1:function(){function c(a,b,c,d){return a<20?b&c|~b&d:a<40?b^c^d:a<60?b&c|b&d|c&d:b^c^d}function d(a){return a<20?1518500249:a<40?1859775393:a<60?-1894007588:-899497514}var a=function(a,b){var c=(a&65535)+(b&65535),d=(a>>16)+(b>>16)+(c>>16);return d<<16|c&65535},b=function(a,b){return a<<b|a>>>32-b};return function(e,f){e[f>>5]|=128<<24-f%32,e[(f+64>>9<<4)+15]=f;var g=Array(80),h=1732584193,i=-271733879,j=-1732584194,k=271733878,l=-1009589776;for(var m=0;m<e.length;m+=16){var n=h,o=i,p=j,q=k,r=l;for(var s=0;s<80;s++){g[s]=s<16?e[m+s]:b(g[s-3]^g[s-8]^g[s-14]^g[s-16],1);var t=a(a(b(n,5),c(s,o,p,q)),a(a(r,g[s]),d(s)));r=q,q=p,p=b(o,30),o=n,n=t}h=a(n,h),i=a(o,i),j=a(p,j),k=a(q,k),l=a(r,l)}return Array(h,i,j,k,l)}}()},this.JSON||(JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)d=rep[c],typeof d=="string"&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),window.PageBus||(window.PageBus={}),PageBus._debug=function(){},PageBus._esc=function(a){return a.replace(/\./g,"!")},PageBus._assertPubTopic=function(a){if(a==null||a==""||a.indexOf("*")!=-1||a.indexOf("..")!=-1||a.charAt(0)=="."||a.charAt(a.length-1)==".")throw new Error(OpenAjax.hub.Error.BadParameters)},PageBus._assertSubTopic=function(a){if(a==null||a=="")throw new Error(OpenAjax.hub.Error.BadParameters);var b=a.split("."),c=b.length;for(var d=0;d<c;d++){var e=b[d];if(e==""||e.indexOf("*")!=-1&&e!="*"&&e!="**")throw new Error(OpenAjax.hub.Error.BadParameters);if(e=="**"&&d<c-1)throw new Error(OpenAjax.hub.Error.BadParameters)}},PageBus._copy=function(a){var b;if(typeof a=="object"){if(a==null)return null;if(a.constructor==Array){b=[];for(var c=0;c<a.length;c++)b[c]=PageBus._copy(a[c]);return b}if(a.constructor==Date)return b=new Date,b.setDate(a.getDate()),b;b={};for(var d in a)b[d]=PageBus._copy(a[d]);return b}return a},PageBus._TopicMatcher=function(){this._items={}},PageBus._TopicMatcher.prototype.store=function(a,b){var c=a.split("."),d=c.length;_recurse=function(e,f){if(f==d)e["."]={topic:a,value:b};else{var g=c[f];e[g]||(e[g]={}),_recurse(e[g],f+1)}},_recurse(this._items,0)},PageBus._TopicMatcher.prototype.match=function(a,b){var c=a.split("."),d=c.length,e=[];return _recurse=function(a,f){if(!a)return;var g;if(f==d)g=a;else{_recurse(a[c[f]],f+1);if(b)return;c[f]!="**"&&_recurse(a["*"],f+1),g=a["**"]}if(!g||!g["."])return;e.push(g["."])},_recurse(this._items,0),e},PageBus._TopicMatcher.prototype.exists=function(a,b){var c=a.split("."),d=c.length,e=!1;return _recurse=function(a,f){if(!a)return;var g;if(f==d)g=a;else{_recurse(a[c[f]],f+1);if(e||b)return;if(c[f]!="**"){_recurse(a["*"],f+1);if(e)return}g=a["**"]}if(!g||!g["."])return;e=!0},_recurse(this._items,0),e},PageBus._TopicMatcher.prototype.clear=function(a){var b=a.split("."),c=b.length;_recurse=function(a,d){if(!a)return;if(d==c)a["."]&&delete a["."];else{_recurse(a[b[d]],d+1);for(var e in a[b[d]])return;delete a[b[d]]}},_recurse(this._items,0)},PageBus._TopicMatcher.prototype.wildcardClear=function(a){var b=a.split("."),c=b.length;_clean=function(a,b){for(m in a[b])return;delete a[b]},_recurse=function(a,d){if(!a)return;if(d==c){a["."]&&delete a["."];return}var e=b[d],f;a[e]&&(_recurse(a[e],d+1),_clean(a,e));if(e=="*")for(f in a)f!="**"&&f!="."&&(_recurse(a[f],d+1),_clean(a,f));else if(e=="**")for(f in a)delete a[f];return},_recurse(this._items,0)},PageBus._TopicMatcher.prototype.wildcardMatch=function(a){var b=a.split("."),c=b.length,d=[];return _recurse=function(a,e){var f=b[e],g;if(!a||e==c)return;if(f=="**")for(var h in a)h!="."&&(g=a[h],g["."]&&d.push(g["."]),_recurse(g,e));else if(f=="*")for(var h in a)h!="."&&h!="**"&&(g=a[h],e==c-1?g["."]&&d.push(g["."]):_recurse(g,e+1));else{g=a[f];if(!g)return;e==c-1?g["."]&&d.push(g["."]):_recurse(g,e+1)}},_recurse(this._items,0),d},PageBus.policy={Ops:{Publish:"p",Subscribe:"s"},Error:{BadParameters:"PageBus.policy.Error.BadParameters"},_assertName:function(a){if(a==null||a=="")throw new Error(OpenAjax.hub.Error.BadParameters);if(PageBus.policy._tops[a])return;var b=a.split("."),c=b.length;for(var d=0;d<c;d++){var e=b[d];if(e==""||e.indexOf("*")!=-1&&e!="*"&&e!="**")throw new Error(PageBus.policy.Error.BadParameters);if(e=="**"&&d<c-1)throw new Error(PageBus.policy.Error.BadParameters)}PageBus.policy._tops[a]=!0},_tops:{}},PageBus.policy.HubPolicy=function(a){a||(a={}),this._cfg=a,this._log=a.log,this._topicMgr=new PageBus._TopicMatcher},PageBus.policy.HubPolicy.prototype.onPublish=function(a,b,c,d){var e=!0,f;if(d!=null){f=d.getPartnerOrigin();if(!f)return!1;e=this.isAllowed.call(this,f,PageBus.policy.Ops.Subscribe,a)}if(e&&c!=null){f=c.getPartnerOrigin();if(!f)return!1;e=this.isAllowed.call(this,f,PageBus.policy.Ops.Publish,a)}if(this._log){var g=d?d.getClientID():"(Mgr)",h=c?c.getClientID():"(Mgr)";this._log("(PageBus.policy) ["+h+", "+g+"] onPublish: "+(e?"ALLOWED ":"DENIED  ")+a)}return e},PageBus.policy.HubPolicy.prototype.onSubscribe=function(a,b){var c=!0,d;if(b!=null){d=b.getPartnerOrigin();if(!d)return!1;c=this.isAllowed.call(this,d,PageBus.policy.Ops.Subscribe,a)}if(this._log){var e=b?b.getClientID():"(Mgr)";this._log("(PageBus.policy) ["+e+"] onSubscribe: "+(c?"ALLOWED ":"DENIED  ")+a)}return c},PageBus.policy.HubPolicy.prototype.onUnsubscribe=function(a,b){},PageBus.policy.HubPolicy.prototype.onSend=function(a,b,c){var d=this.isAllowed(c,PageBus.policy.Ops.Subscribe,a);return this._log&&this._log("(PageBus.policy) ["+c+"] onSend: "+(d?"ALLOWED ":"DENIED  ")+a),d},PageBus.policy.HubPolicy.prototype.onReceive=function(a,b,c){var d=this.isAllowed(c,PageBus.policy.Ops.Publish,a);return this._log&&this._log("(PageBus.policy) ["+c+"] onReceive: "+(d?"ALLOWED ":"DENIED  ")+a),d},PageBus.policy.HubPolicy.prototype._getMyOrigin=function(){var a=window.location.href.match(/[^:]*:\/\/[^:\/\?#]*/);return a[0]},PageBus.policy.HubPolicy.prototype.grant=function(a,b,c){if(!a||!b||!c)throw new Error(PageBus.policy.Error.BadParameters);var d=PageBus._esc(a)+"."+b+"."+c;PageBus.policy._assertName(d),this._topicMgr.store(d,{dm:a,op:b,tp:c}),this._log&&this._log("(PageBus.policy) ["+a+"] grant: "+b+" on "+c);var e="_pagebus.cache.s."+c;this._topicMgr.store(PageBus._esc(a)+"."+b+"."+e,{dm:a,op:b,tp:e}),this._log&&this._log("(PageBus.policy) ["+a+"] implicit grant: "+b+" on "+e)},PageBus.policy.HubPolicy.prototype.revoke=function(a,b,c){if(!a||!b||!c)throw new Error(PageBus.policy.Error.BadParameters);var d=PageBus._esc(a)+"."+b+"."+c;PageBus.policy._assertName(d),this._topicMgr.clear(d),this._log&&this._log("(PageBus.policy) ["+a+"] revoke: "+b+" on "+c);var e="_pagebus.cache.s."+c;this._topicMgr.clear(PageBus._esc(a)+"."+b+"."+e),this._log&&this._log("(PageBus.policy) ["+a+"] implicit revoke: "+b+" on "+e)},PageBus.policy.HubPolicy.prototype.revokeAll=function(a){if(!a)throw new Error(PageBus.policy.Error.BadParameters);this._topicMgr.wildcardClear(PageBus._esc(a)+".**"),this._log&&this._log("(PageBus.policy) ["+a+"] revokeAll")},PageBus.policy.HubPolicy.prototype.isAllowed=function(a,b,c){if(!a||a==""||!b||b==""||!c||c=="")throw new Error(PageBus.policy.Error.BadParameters);var d=PageBus._esc(a)+"."+b+"."+c;return this._topicMgr.exists(d,!1)},PageBus.policy.HubPolicy.prototype.listAllowed=function(a,b){if(!a||!b)throw new Error(PageBus.policy.Error.BadParameters);var c=this._topicMgr.wildcardMatch(PageBus._esc(a)+"."+b+".**"),d=[];for(var e in c)c[e].value.tp.substring(0,9)!="_pagebus."&&d.push(c[e].value.tp);return d},PageBus.cache={},PageBus.cache.Error={NoCache:"PageBus.cache.Error.NoCache"},PageBus._cache={},PageBus._cache.isCacheable=function(a){return a&&typeof a=="object"&&a.PageBus&&a.PageBus.cache},PageBus._cache.Cache=function(){this._refs={},this._doCache=new PageBus._TopicMatcher,this._caches=new PageBus._TopicMatcher},PageBus._cache.Cache.prototype.add=function(a,b){var c,d=this._doCache.match(a,!0);d.length>0?c=d[0].value:(c={rc:0},this._doCache.store(a,c)),c.rc++,this._refs[b]=a},PageBus._cache.Cache.prototype.remove=function(a){var b=this._refs[a];if(!b)return;delete this._refs[a];var c=this._doCache.match(b,!0);if(c.length==0)return;c[0].value.rc--;if(c[0].value.rc==0){this._doCache.clear(b);var d=this._caches.wildcardMatch(b);for(var e=0;e<d.length;e++)this._doCache.exists(d[e].topic,!1)||this._caches.clear(d[e].topic)}},PageBus._cache.Cache.prototype.storeCopy=function(a,b){PageBus._assertPubTopic(a);var c=PageBus._copy(b);this._caches.store(a,c)},PageBus._cache.Cache.prototype.clear=function(a,b){PageBus._assertPubTopic(a),this._caches.clear(a)},PageBus._cache.Cache.prototype.query=function(a){return PageBus._assertSubTopic(a),this._caches.wildcardMatch(a)},PageBus._cache.Cache.prototype.isCaching=function(a){for(var b in this._refs)!1;return this._doCache.exists(a,!1)},PageBus._enableMH=function(){var a=OpenAjax.hub.ManagedHub;OpenAjax.hub.ManagedHub=function(b){if(!b)throw new Error(OpenAjax.hub.Error.BadParameters);if(!b.onPublish||!b.onSubscribe)throw new Error(OpenAjax.hub.Error.BadParameters);var c={},d=null;b.PageBus||(b.PageBus={}),b.PageBus.policy||(b.PageBus.policy=d),b.scope||(b.scope=window),this._pagebus={_params:{},_getActualParameters:function(){return this._pagebus._params},_policy:b.PageBus.policy,_hub:this},this.pagebus={_hub:this};var e=this._pagebus;e._cache=new PageBus._cache.Cache,this.pagebus.query=function(a){return this._hub._pagebus._cache.query(a)},this.pagebus.store=function(a,b){this._hub._pagebus._cache.isCaching(a)&&this._hub.publish(a,b)},this.pagebus.clear=function(a){this._hub._pagebus._cache.isCaching(a)&&this._hub.publish(a,null)};var f=b.scope?b.scope:window,g=this._pagebus._params;for(var h in b)g[h]=b[h];g.scope=b.scope?b.scope:window,g.onPublish=function(a,c,d,e){try{var h=g.PageBus.policy;if(h){var i=h.onPublish.call(h,a,c,d,e);if(!i)return!1}return b.onPublish.call(f,a,c,d,e)}catch(j){return!1}},g.onSubscribe=function(a,c){try{var d=g.PageBus.policy;if(d){var e=d.onSubscribe.call(d,a,c);if(!e)return!1}return e=b.onSubscribe.call(f,a,c),e}catch(h){return!1}},g.onUnsubscribe=function(a,c){try{var d=g.PageBus.policy;d&&d.onUnsubscribe.call(d,b.scope,a,c),b.onUnsubscribe.call(f,a,c)}catch(e){return}},e._policy||(e._policy=null),a.call(this,g),this.getParameters=function(){return b}},OpenAjax.hub.ManagedHub.prototype=a.prototype;var b=OpenAjax.hub.ManagedHub.prototype.publish,c=OpenAjax.hub.ManagedHub.prototype.subscribe,d=OpenAjax.hub.ManagedHub.prototype.unsubscribe,e=OpenAjax.hub.ManagedHub.prototype.publishForClient,f=OpenAjax.hub.ManagedHub.prototype.subscribeForClient,g=OpenAjax.hub.ManagedHub.prototype.unsubscribeForClient,h=OpenAjax.hub.ManagedHub.prototype.getScope;OpenAjax.hub.ManagedHub.prototype.publish=function(a,c){PageBus._assertPubTopic(a),this._pagebus._cache.isCaching(a)&&(c==null?this._pagebus._cache.clear(a):this._pagebus._cache.storeCopy(a,c)),b.call(this,a,c)},OpenAjax.hub.ManagedHub.prototype.subscribe=function(a,b,d,e,f){PageBus._assertSubTopic(a);var g=c.call(this,a,b,d,e,f);if(PageBus._cache.isCacheable(f)){var h=this._pagebus._cache;h.add(a,g);var i=h.query(a);for(var j=0;j<i.length;j++)try{b.call(d?d:window,i[j].topic,i[j].value,f)}catch(k){PageBus._debug()}}return g},OpenAjax.hub.ManagedHub.prototype.unsubscribe=function(a,b,c){var e=this._pagebus._cache;e.remove(a),d.call(this,a,b,c)},OpenAjax.hub.ManagedHub.prototype.getScope=function(){return h.call(this)},OpenAjax.hub.ManagedHub.prototype.publishForClient=function(a,b,c){PageBus._assertPubTopic(b),(!this._pagebus._policy||this._pagebus._policy.isAllowed(a.getPartnerOrigin(),PageBus.policy.Ops.Publish,b))&&this._pagebus._cache.isCaching(b)&&(c==null?this._pagebus._cache.clear(b):this._pagebus._cache.storeCopy(b,c)),e.call(this,a,b,c)},OpenAjax.hub.ManagedHub.prototype.subscribeForClient=function(a,b,c){PageBus._assertSubTopic(b);var d=f.call(this,a,b,c);if(b.substring(0,17)=="_pagebus.cache.s."){var e=b.substring(17);this._pagebus._cache.add(e,d);var g=this._pagebus._cache.query(e);function h(){for(var b=0;b<g.length;b++)a.sendToClient(g[b].topic,g[b].value,c)}setTimeout(h,0)}return d},OpenAjax.hub.ManagedHub.prototype.unsubscribeForClient=function(a,b){this._pagebus._cache.remove(b);try{var c=this.getSubscriberData(b);PageBus._cache.isCacheable(c)&&this._pagebus._cacheSids[b]&&(this.unsubscribe(this._pagebus._cacheSids[b],null,null),delete this._pagebus._cacheSids[b],this._pagebus._cache.remove(b)),g.call(this,a,b)}catch(d){PageBus._debug()}}},PageBus._enableMH(),PageBus.HubClientExtender=function(a,b){var c=this;this._hub=a,this._params=b,b.PageBus||(this._params.PageBus={log:b.log}),b.PageBus.policy||(b.PageBus.policy=null),this._policy=b.PageBus.policy,this._cache=new PageBus._cache.Cache,this._cacheSids={},this._wrappedSubscribe=a.subscribe,this._wrappedUnsubscribe=a.unsubscribe,this._wrappedPublish=a.publish,this._wrappedDisconnect=a.disconnect,a.publish=function(a,b){c._publishWrapper(a,b)},a.subscribe=function(a,b,d,e,f){return c._subscribeWrapper(a,b,d,e,f)},a.unsubscribe=function(a,b,d){c._unsubscribeWrapper(a,b,d)},a.disconnect=function(a,b){c._disconnectWrapper(a,b)}},PageBus.HubClientExtender.prototype._publishWrapper=function(a,b){if(!this._hub.isConnected())throw new Error(OpenAjax.hub.Error.Disconnected);PageBus._assertPubTopic(a),this._cache.isCaching(a)&&(b==null?this._cache.clear(a):this._cache.storeCopy(a,b));var c=this._hub.getPartnerOrigin();if(!c)throw new Error(OpenAjax.hub.Error.Disconnected);if(this._policy&&!this._policy.onSend(a,b,c))return;this._wrappedPublish.call(this._hub,a,b)},PageBus.HubClientExtender.prototype._subscribeWrapper=function(a,b,c,d,e){var f=this;if(!this._hub.isConnected())throw new Error(OpenAjax.hub.Error.Disconnected);PageBus._assertSubTopic(a);if(!b)throw new Error(OpenAjax.hub.Error.BadParameters);var g=this._policy,h=this._hub.getPartnerOrigin();if(!h)throw new Error(OpenAjax.hub.Error.Disconnected);if(g&&!g.onReceive.call(g,a,null,h))throw new Error(OpenAjax.hub.Error.NotAllowed);dataHook=function(a,d,e){var g=f._policy,h=f._hub.getPartnerOrigin();if(g&&!g.onReceive.call(g,a,d,h))return;PageBus._cache.isCacheable(e)&&f._cache.isCaching(a)&&(d==null?f._cache.clear(a):f._cache.storeCopy(a,d));try{var i=c?c:window;b.call(i,a,d,e)}catch(j){PageBus._debug()}},completeHook=function(a,b,e){b||f._cacheSids[a]&&(f._hub.unsubscribe(f._cacheSids[a],null,null),delete f._cacheSids[a],f._cache.remove(a));try{var g=c?c:window;d.call(g,a,b,e)}catch(h){PageBus._debug()}};var i=this._wrappedSubscribe.call(this._hub,a,dataHook,c,completeHook,e);try{this._hub.getSubscriberData(i)}catch(j){if(j.message==OpenAjax.hub.Error.NoSubscription)return i}return PageBus._cache.isCacheable(e)&&(this._cache.add(a,i),this._cacheSids[i]=this._hub.subscribe("_pagebus.cache.s."+a,function(a,d,f){var g=this._policy,h=this._hub.getPartnerOrigin();if(g&&!this._policy.onReceive(a,d,h))return;PageBus._cache.isCacheable(e)&&this._cache.isCaching(a)&&(d==null?this._cache.clear(a):this._cache.storeCopy(a,d));try{var i=c?c:window;b.call(i,a,d,e)}catch(j){PageBus._debug()}},this,function(a,b,c){},null)),i},PageBus.HubClientExtender.prototype._unsubscribeWrapper=function(a,b,c){if(!this._hub.isConnected())throw new Error(OpenAjax.hub.Error.Disconnected);if(a==null||a=="")throw new Error(OpenAjax.hub.Error.BadParameters);var d=this._hub.getSubscriberData(a);PageBus._cache.isCacheable(d)&&this._cacheSids[a]&&(this._hub.unsubscribe(this._cacheSids[a],null,null),delete this._cacheSids[a],this._cache.remove(a)),this._wrappedUnsubscribe.call(this._hub,a,b,c)},PageBus.HubClientExtender.prototype._disconnectWrapper=function(a,b){this._cache._caches.wildcardClear("**"),this._cacheSids={},this._wrappedDisconnect.call(this._hub,a,b)},PageBus.HubClientExtender.prototype.query=function(a){return this._cache.query(a)},PageBus.HubClientExtender.prototype.store=function(a,b){if(!this._cache.isCaching(a))throw new Error(PageBus.cache.Error.NoCache);this._hub.publish(a,b)},PageBus.HubClientExtender.prototype.clear=function(a){if(!this._cache.isCaching(a))throw new Error(PageBus.cache.Error.NoCache);this._hub.publish(a,null)},PageBus.enableHubClientClass=function(a){a.prototype._pagebusWrappedConnect=a.prototype.connect,a.prototype.connect=function(a,b){var c=this;c.pagebus||(c.pagebus=new PageBus.HubClientExtender(c,c.getParameters())),c._pagebusWrappedConnect.call(c,a,b)}};if(!OpenAjax.hub)debuggerOpenAjax.hub.InlineHubClient&&PageBus.enableHubClientClass(OpenAjax.hub.InlineHubClient),OpenAjax.hub.IframeHubClient&&PageBus.enableHubClientClass(OpenAjax.hub.IframeHubClient),OpenAjax.hub._hub=new OpenAjax.hub.ManagedHub({onSubscribe:function(a,b){return!0},onPublish:function(a,b,c,d){return!0}}),OpenAjax.hub.subscribe=function(a,b,c,d){return typeof b=="string"&&(c=c||window,b=c[b]||null),OpenAjax.hub._hub.subscribe(a,b,c,null,d)},OpenAjax.hub.unsubscribe=function(a){return OpenAjax.hub._hub.unsubscribe(a)},OpenAjax.hub.publish=function(a,b){OpenAjax.hub._hub.publish(a,b)},PageBus.publish=function(a,b){OpenAjax.hub.publish(a,b)},PageBus.subscribe=function(a,b,c,d){return OpenAjax.hub.subscribe(a,c,b,d)},PageBus.unsubscribe=function(a){OpenAjax.hub.unsubscribe(a)},PageBus.store=function(a,b){OpenAjax.hub._hub.pagebus.store(a,b)},PageBus.query=function(a){return OpenAjax.hub._hub.pagebus.query(a)},OpenAjax.hub.registerLibrary("PageBus","http://pagebus.org/pagebus","2.0",{})