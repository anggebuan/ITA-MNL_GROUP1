CREATE VIEW MNL_ITS_VC_SCHEDULE_RVW AS
SELECT B.VOYAGE_CODE,
  C.PORT_CODE,
  B.CALL_NUM,
  A.BERTH_ARRIVAL_IODT,
  A.BERTH_DEPARTURE_IODT
FROM MNL_ITS_SCHED A,
  MNL_ITS_VOY_CTRL B,
  MNL_GSP_GEO C
WHERE A.VOYAGE_CODE = B.VOYAGE_CODE
AND B.PORT_ID       = C.PORT_ID
AND A.CALL_NUM      = B.CALL_NUM; 

/* OUTPUT
1111	AAA1-JUN-074 S	BCD	1	20101020044000.000	20101020084000.000
1112	BBB1-JUN-042 S	BCD	1	20100812091500.000	20100812095000.000
*/


CREATE VIEW MNL_ITS_SCHEDULE_RVW AS
SELECT A.VOYAGE_ID,
A.VOYAGE_CODE,
A.CALL_NUM,
B.PORT_ID,
A.PORT_CODE,
B.PORT_NAME,
A.FACILITY_ID,
B.FACILITY_CODE,
B.FACILITY_NAME,
A.STOP_SEQ,
A.BERTH_ARRIVAL_IODT,
A.BERTH_DEPARTURE_IODT,
A.CARGO_AVAILABILITY_IODT,
A.CARGO_CUTOFF_IODT
FROM MNL_ITS_SCHED A,
    MNL_GSP_GEO B
WHERE A.PORT_CODE = B.PORT_CODE
AND A.FACILITY_ID = B.FACILITY_ID;

/*OUTPUT
1	AAA1-JUN-074 S	1	1000	ABC	Termontes Terminal	100	ABC01	Montrial	1	20101020044000.000	20101020084000.000	20101019030000.000	20101020084000.000
2	BBB1-JUN-042 S	1	1000	ABC	Termontes Terminal	100	ABC01	Montrial	2	20100812091500.000	20100812095000.000	20100813030000.000	20100812095000.000
*/

COMMIT;