--HOMEWORK 14AUG2017

CREATE TABLE MNL_ITS_SCHED(
	VOYAGE_CODE		VARCHAR(25) NOT NULL PRIMARY KEY, 
	SERVICE_CODE	VARCHAR(6) NOT NULL,
	VESSEL_CODE	VARCHAR(6) NOT NULL,
	VOYAGE_NUM	VARCHAR(6) NOT NULL,
	DIRECTION	VARCHAR(5) NOT NULL,
	CALL_NUM	VARCHAR(2) NOT NULL,
	PORT_CODE	VARCHAR(6) NOT NULL,
	STOP_SEQ	VARCHAR(2) NOT NULL,
	FACILITY_ID	NUMBER(20) NOT NULL,
	BERTH_ARRIVAL_IODT	VARCHAR(25) NOT NULL,
	BERTH_DEPARTURE_IODT	VARCHAR(25) NOT NULL,
	CARGO_AVAILABILITY_IODT VARCHAR(25),
	CARGO_CUTOFF_IODT VARCHAR(25)
);

INSERT INTO MNL_ITS_SCHED VALUES ('1','AAA1-JUN-074 S','AAA1','JUN','074','South','1','ABC','1','100','20101020044000.000','20101020084000.000','20101019030000.000','20101020084000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('2','BBB1-JUN-042 S','BBB1','JUN','042','South','1','ABC','2','100','20100812091500.000','20100812095000.000','20100813030000.000','20100812095000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('3','CCC1-JUN-037 S','CCC1','JUN','037','South','1','ABC','3','100','20100529104000.000','20100529203000.000','20100529030000.000','20100529203000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('4','EEE1-JUN-995 S','EEE1','JUN','995','South','1','ABC','1','100','20091127022000.000','20091127060000.000','20091127090000.000','20091127060000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('5','FFF1-JUN-844 S','FFF1','JUN','844','South','1','ABC','4','100','20080602172000.000','20080602230000.000','20080602040000.000','20080602230000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('6','GGG1-JUN-123 S','GGG1','JUN','123','South','1','ABC','2','100','20070930220000.000','20071001220000.000','20070930220000.000','20071001220000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('7','HHH1-KAT-130 S','HHH1','KAT','130','South','1','ABC','3','100','20110413183000.000','20110414230000.000','20110414050000.000','20110414230000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('8','III1-KAT-928 S','III1','KAT','928','South','1','ABC','1','100','20090407074000.000','20090407114000.000','20090407040000.000','20090407114000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('9','JJJ1-KAT-063 S','JJJ1','KAT','063','South','1','ABC','4','100','20100807032500.000','20100807093000.000','20100806090000.000','20100807093000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('10','KKK1-KAT-026 S','KKK1','KAT','026','South','1','ABC','2','100','20120304060000.000','20120304230000.000','20120303200000.000','20120304230000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('11','LLL1-KAT-110 S','LLL1','KAT','110','South','1','ABC','3','100','20110701121000.000','20110701135000.000','20110702030000.000','20110701135000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('12','MMM1-KAT-393 S','MMM1','KAT','393','South','1','ABC','1','100','20111026151500.000','20111026153800.000','20111027210000.000','20111026153800.000');
INSERT INTO MNL_ITS_SCHED VALUES ('13','NNN1-KAT-018 S','NNN1','KAT','018','South','1','ABC','2','100','20120607104800.000','20120607215000.000','20120607210000.000','20120607215000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('14','OOO1-KIM-761 S','OOO1','KIM','761','South','1','ABC','3','100','20120217075000.000','20120218083500.000','20120216235000.000','20120218083500.000');
INSERT INTO MNL_ITS_SCHED VALUES ('15','PPP1-KIM-035 S','PPP1','KIM','035','South','1','ABC','4','100','20120317172000.000','20120318021500.000','20120318180000.000','20120318021500.000');
INSERT INTO MNL_ITS_SCHED VALUES ('16','QQQ1-KIM-101 S','QQQ1','KIM','101','South','1','ABC','1','100','20111230150000.000','20120103020000.000','20111230180000.000','20120103020000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('17','RRR1-KIM-051 S','RRR1','KIM','051','South','1','ABC','2','100','20120212211000.000','20120213062500.000','20120213080000.000','20120213062500.000');
INSERT INTO MNL_ITS_SCHED VALUES ('18','SSS1-KIM-085 S','SSS1','KIM','085','South','1','ABC','1','100','20070930220000.000','20120106140000.000','20120106140000.000','20120106140000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('19','TTT1-KIM-145 S','TTT1','KIM','145','South','1','ABC','1','100','20030316223000.000','20030319035000.000','20030316100000.000','20030319035000.000');
INSERT INTO MNL_ITS_SCHED VALUES ('20','POG1-MON-143 S','POG1','MON','143','South','1','ABC','1','100','20030513223000.000','20030310350000.000','20030310350000.000','20030310350000.000');


SELECT * FROM MNL_ITS_SCHED;
/*
OUTPUT:
1	AAA1-JUN-074 S	AAA1	JUN	074	South	1	ABC	1	100	20101020044000.000	20101020084000.000	20101019030000.000	20101020084000.000
2	BBB1-JUN-042 S	BBB1	JUN	042	South	1	ABC	2	100	20100812091500.000	20100812095000.000	20100813030000.000	20100812095000.000
3	CCC1-JUN-037 S	CCC1	JUN	037	South	1	ABC	3	100	20100529104000.000	20100529203000.000	20100529030000.000	20100529203000.000
4	EEE1-JUN-995 S	EEE1	JUN	995	South	1	ABC	1	100	20091127022000.000	20091127060000.000	20091127090000.000	20091127060000.000
5	FFF1-JUN-844 S	FFF1	JUN	844	South	1	ABC	4	100	20080602172000.000	20080602230000.000	20080602040000.000	20080602230000.000
6	GGG1-JUN-123 S	GGG1	JUN	123	South	1	ABC	2	100	20070930220000.000	20071001220000.000	20070930220000.000	20071001220000.000
7	HHH1-KAT-130 S	HHH1	KAT	130	South	1	ABC	3	100	20110413183000.000	20110414230000.000	20110414050000.000	20110414230000.000
8	III1-KAT-928 S	III1	KAT	928	South	1	ABC	1	100	20090407074000.000	20090407114000.000	20090407040000.000	20090407114000.000
9	JJJ1-KAT-063 S	JJJ1	KAT	063	South	1	ABC	4	100	20100807032500.000	20100807093000.000	20100806090000.000	20100807093000.000
10	KKK1-KAT-026 S	KKK1	KAT	026	South	1	ABC	2	100	20120304060000.000	20120304230000.000	20120303200000.000	20120304230000.000
11	LLL1-KAT-110 S	LLL1	KAT	110	South	1	ABC	3	100	20110701121000.000	20110701135000.000	20110702030000.000	20110701135000.000
12	MMM1-KAT-393 S	MMM1	KAT	393	South	1	ABC	1	100	20111026151500.000	20111026153800.000	20111027210000.000	20111026153800.000
13	NNN1-KAT-018 S	NNN1	KAT	018	South	1	ABC	2	100	20120607104800.000	20120607215000.000	20120607210000.000	20120607215000.000
14	OOO1-KIM-761 S	OOO1	KIM	761	South	1	ABC	3	100	20120217075000.000	20120218083500.000	20120216235000.000	20120218083500.000
15	PPP1-KIM-035 S	PPP1	KIM	035	South	1	ABC	4	100	20120317172000.000	20120318021500.000	20120318180000.000	20120318021500.000
16	QQQ1-KIM-101 S	QQQ1	KIM	101	South	1	ABC	1	100	20111230150000.000	20120103020000.000	20111230180000.000	20120103020000.000
17	RRR1-KIM-051 S	RRR1	KIM	051	South	1	ABC	2	100	20120212211000.000	20120213062500.000	20120213080000.000	20120213062500.000
18	SSS1-KIM-085 S	SSS1	KIM	085	South	1	ABC	1	100	20070930220000.000	20120106140000.000	20120106140000.000	20120106140000.000
19	TTT1-KIM-145 S	TTT1	KIM	145	South	1	ABC	1	100	20030316223000.000	20030319035000.000	20030316100000.000	20030319035000.000
20	POG1-MON-143 S	POG1	MON	143	South	1	ABC	1	100	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
21	POG1-MON-143 S	POG1	MON	143	South	1	HIJ	2	106	20020513223000.000	20020310350000.000	20020310350000.000	20020310350000.000
22	POG1-MON-143 S	POG1	MON	143	South	1	BCD	3	101	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
23	POG1-MON-144 N	POG1	MON	144	North	1	CDE	4	102	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
24	POG1-MON-144 N	POG1	MON	144	North	2	HIJ	5	106	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
*/


--EXERCISE 2
SELECT * FROM MNL_ITS_SCHED WHERE VESSEL_CODE = 'MON';
/*
OUTPUT:
20	POG1-MON-143 S	POG1	MON	143	South	1	ABC	1	100	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
21	POG1-MON-143 S	POG1	MON	143	South	1	HIJ	2	106	20020513223000.000	20020310350000.000	20020310350000.000	20020310350000.000
22	POG1-MON-143 S	POG1	MON	143	South	1	BCD	3	101	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
23	POG1-MON-144 N	POG1	MON	144	North	1	CDE	4	102	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
24	POG1-MON-144 N	POG1	MON	144	North	2	HIJ	5	106	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000
*/

--EXERCISE 3
SELECT * FROM MNL_ITS_SCHED WHERE VOYAGE_ID BETWEEN 1 AND 10;
/*
OUTPUT:
1	AAA1-JUN-074 S	AAA1	JUN	074	South	1	ABC	1	100	20101020044000.000	20101020084000.000	20101019030000.000	20101020084000.000
2	BBB1-JUN-042 S	BBB1	JUN	042	South	1	ABC	2	100	20100812091500.000	20100812095000.000	20100813030000.000	20100812095000.000
3	CCC1-JUN-037 S	CCC1	JUN	037	South	1	ABC	3	100	20100529104000.000	20100529203000.000	20100529030000.000	20100529203000.000
4	EEE1-JUN-995 S	EEE1	JUN	995	South	1	ABC	1	100	20091127022000.000	20091127060000.000	20091127090000.000	20091127060000.000
5	FFF1-JUN-844 S	FFF1	JUN	844	South	1	ABC	4	100	20080602172000.000	20080602230000.000	20080602040000.000	20080602230000.000
6	GGG1-JUN-123 S	GGG1	JUN	123	South	1	ABC	2	100	20070930220000.000	20071001220000.000	20070930220000.000	20071001220000.000
7	HHH1-KAT-130 S	HHH1	KAT	130	South	1	ABC	3	100	20110413183000.000	20110414230000.000	20110414050000.000	20110414230000.000
8	III1-KAT-928 S	III1	KAT	928	South	1	ABC	1	100	20090407074000.000	20090407114000.000	20090407040000.000	20090407114000.000
9	JJJ1-KAT-063 S	JJJ1	KAT	063	South	1	ABC	4	100	20100807032500.000	20100807093000.000	20100806090000.000	20100807093000.000
10	KKK1-KAT-026 S	KKK1	KAT	026	South	1	ABC	2	100	20120304060000.000	20120304230000.000	20120303200000.000	20120304230000.000
*/

--EXERCISE 4
SELECT * FROM MNL_ITS_SCHED A, MNL_ITS_VOY_CTRL B
WHERE A.VOYAGE_CODE = B.VOYAGE_CODE
AND A.VESSEL_CODE = 'MON';
/*
OUTPUT:
22	POG1-MON-143 S	POG1	MON	143	South	1	BCD	3	101	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000	1130	POG1-MON-143 S	OB	1	1001			201708131000.009	20170202100000.019
21	POG1-MON-143 S	POG1	MON	143	South	1	HIJ	2	106	20020513223000.000	20020310350000.000	20020310350000.000	20020310350000.000	1130	POG1-MON-143 S	OB	1	1001			201708131000.009	20170202100000.019
20	POG1-MON-143 S	POG1	MON	143	South	1	ABC	1	100	20030513223000.000	20030310350000.000	20030310350000.000	20030310350000.000	1130	POG1-MON-143 S	OB	1	1001			201708131000.009	20170202100000.019
*/

--EXERCISE 5
SELECT B.* FROM MNL_ITS_SCHED A, MNL_ITS_VOY_CTRL B
WHERE A.VOYAGE_CODE IN B.VOYAGE_CODE
AND A.VESSEL_CODE = 'JUN';
/*
OUTPUT:
1111	AAA1-JUN-074 S	IB	1	1001	20170815101200.000	20170815120000.000		20170202100000.000
1112	BBB1-JUN-042 S	IB	1	1001	20170815101200.001	20170815120000.001		20170202100000.001
1113	CCC1-JUN-037 S	IB	1	1001	20170815101200.002	20170815120000.002		20170202100000.002
1114	EEE1-JUN-995 S	IB	1	1001	20170815101200.003	20170815120000.003		20170202100000.003
1115	FFF1-JUN-844 S	IB	1	1001	20170815101200.004	20170815120000.004		20170202100000.004
1116	GGG1-JUN-123 S	IB	1	1001	20170815101200.005	20170815120000.005		20170202100000.005
*/


--EXERCISE 6
SELECT * FROM MNL_ITS_VOY_CTRL WHERE BL_ISSUE_IODT IS NULL;
/*
OUTPUT:
1121	LLL1-KAT-110 S	OB	1	1001			201708131000.000	20170202100000.010
1122	MMM1-KAT-393 S	OB	1	1001			201708131000.001	20170202100000.011
1123	NNN1-KAT-018 S	OB	1	1001			201708131000.002	20170202100000.012
1124	OOO1-KIM-761 S	OB	1	1001			201708131000.003	20170202100000.013
1125	PPP1-KIM-035 S	OB	1	1001			201708131000.004	20170202100000.014
1126	QQQ1-KIM-101 S	OB	1	1001			201708131000.005	20170202100000.015
1127	RRR1-KIM-051 S	OB	1	1001			201708131000.006	20170202100000.016
1128	SSS1-KIM-085 S	OB	1	1001			201708131000.007	20170202100000.017
1129	TTT1-KIM-145 S	OB	1	1001			201708131000.008	20170202100000.018
1130	POG1-MON-143 S	OB	1	1001			201708131000.009	20170202100000.019
*/

--EXERCISE 7
SELECT DISTINCT VOYAGE_CODE FROM MNL_ITS_VOY_CTRL;
/*
OUTPUT:
OOO1-KIM-761 S
HHH1-KAT-130 S
III1-KAT-928 S
NNN1-KAT-018 S
FFF1-JUN-844 S
GGG1-JUN-123 S
CCC1-JUN-037 S
KKK1-KAT-026 S
SSS1-KIM-085 S
RRR1-KIM-051 S
AAA1-JUN-074 S
BBB1-JUN-042 S
LLL1-KAT-110 S
TTT1-KIM-145 S
MMM1-KAT-393 S
POG1-MON-143 S
EEE1-JUN-995 S
JJJ1-KAT-063 S
PPP1-KIM-035 S
QQQ1-KIM-101 S
*/

--EXERCISE 8
SELECT * FROM MNL_ITS_SCHED 
WHERE BERTH_ARRIVAL_IODT LIKE '%2011%';
/*
OUTPUT:
7	HHH1-KAT-130 S	HHH1	KAT	130	South	1	ABC	3	100	20110413183000.000	20110414230000.000	20110414050000.000	20110414230000.000
11	LLL1-KAT-110 S	LLL1	KAT	110	South	1	ABC	3	100	20110701121000.000	20110701135000.000	20110702030000.000	20110701135000.000
12	MMM1-KAT-393 S	MMM1	KAT	393	South	1	ABC	1	100	20111026151500.000	20111026153800.000	20111027210000.000	20111026153800.000
16	QQQ1-KIM-101 S	QQQ1	KIM	101	South	1	ABC	1	100	20111230150000.000	20120103020000.000	20111230180000.000	20120103020000.000
*/

SELECT * FROM MNL_ITS_SCHED 
WHERE BERTH_ARRIVAL_IODT LIKE '%2011';
/*
OUTPUT:
NO DATA FOUND THAT FITS WITH THE CONDITION
*/

SELECT * FROM MNL_ITS_SCHED 
WHERE BERTH_ARRIVAL_IODT LIKE '2011%';
/*
OUTPUT:
7	HHH1-KAT-130 S	HHH1	KAT	130	South	1	ABC	3	100	20110413183000.000	20110414230000.000	20110414050000.000	20110414230000.000
11	LLL1-KAT-110 S	LLL1	KAT	110	South	1	ABC	3	100	20110701121000.000	20110701135000.000	20110702030000.000	20110701135000.000
12	MMM1-KAT-393 S	MMM1	KAT	393	South	1	ABC	1	100	20111026151500.000	20111026153800.000	20111027210000.000	20111026153800.000
16	QQQ1-KIM-101 S	QQQ1	KIM	101	South	1	ABC	1	100	20111230150000.000	20120103020000.000	20111230180000.000	20120103020000.000
*/


